"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[710],{15710:function(e,t,n){n.r(t);var a=n(72791),o=n(55294),r=n(57689),s=n(82570),i=(n(99696),n(69768)),l=n(74177),c=n(27112),d=(n(21830),n(80184));t.default=()=>{const e=(0,r.s0)(),[t,n]=(0,a.useState)(!1),[u,m]=(0,a.useState)(),[p,f]=(0,a.useState)(null),[h,g]=(0,a.useState)([]),[w,v]=(0,a.useState)("");(0,a.useEffect)((()=>{(()=>{const e=window.localStorage.getItem("wittle-subscription-tier");console.log("tier ->",e),k(e?{...S,tier:e}:{...S,tier:"Free"})})(),(async()=>{try{const e="/api/branch_list/",{data:t}=await o.Z.get(e);console.log("agent list ->",t),m(t);const n=t.map((e=>({value:e.id,label:e.branch_name})));g(n),console.log("company list ->",n)}catch(e){console.log(e)}})()}),[]);const[x,j]=(0,a.useState)("password"),[F,b]=(0,a.useState)("password"),[y,C]=(0,a.useState)(!1),[_,N]=(0,a.useState)(!1),[S,k]=(0,a.useState)({email:"",company_name:"",password:"",password_confirmation:"",first_name:"",last_name:"",tier:"Free"}),[L,D]=(0,a.useState)({email:"",company_name:"",password:"",password_confirmation:"",first_name:"",last_name:"",post:""}),E=e=>{const{name:t,value:n}=e.target;if(k("email"===t?{...S,[t]:n.toLowerCase()}:{...S,[t]:n}),"password"===t){const e=(e=>{const t=(0,s.matches)(e,/[A-Z]/),n=(0,s.matches)(e,/[a-z]/),a=(0,s.matches)(e,/\d/),o=(0,s.matches)(e,/[^A-Za-z0-9]/);return(0,s.isLength)(e,{min:8})?t?n?a?o?"":"Password must contain at least one special character":"Password must contain at least one digit":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter":"Password must be at least 8 characters long"})(n);D({...L,password:e})}else if("password_confirmation"===t){const e=n!==S.password?"Passwords don't match":"";D({...L,password_confirmation:e})}};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("section",{className:"login-page",id:"register",children:t?(0,d.jsx)(l.Z,{}):(0,d.jsxs)("section",{className:"login-content",children:[(0,d.jsx)("div",{className:"logo-section",children:(0,d.jsx)("div",{className:"wittle-logo",onClick:()=>e("/")})}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"register-title",children:(0,d.jsx)("h1",{children:"Unlock the benefits of Wittle"})}),(0,d.jsxs)("div",{className:"register-section",children:[(0,d.jsxs)("div",{className:"login-double-input",children:[(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"First name"}),(0,d.jsx)("input",{type:"text",name:"first_name",className:"input",value:S.first_name,onChange:E}),L.first_name&&(0,d.jsxs)("p",{className:"error",children:["* ",L.first_name]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Last name"}),(0,d.jsx)("input",{type:"text",name:"last_name",className:"input",value:S.last_name,onChange:E}),L.last_name&&(0,d.jsxs)("p",{className:"error",children:["* ",L.last_name]})]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Company"}),(0,d.jsx)(i.Z,{isClearable:!0,onChange:(e,t)=>{f(e);const n=e?e.label:"";k({...S,company_name:n})},options:h,value:p,styles:{control:e=>({...e,fontSize:"0.8rem",fontFamily:"Poppins",color:"#FDF7F0",borderColor:"#FDF7F0",borderRadius:"10px",backgroundColor:"#1A276C",padding:"0px 0px",minHeight:"35px"}),option:(e,t)=>({...e,color:t.isSelected?"white":"#333",backgroundColor:t.isSelected?"#1A276C":"white",fontSize:"0.8rem"}),singleValue:(e,t)=>({...e,color:"#FDF7F0",fontSize:"0.8rem",fontFamily:"Poppins",padding:"0px 0px"}),input:e=>({...e,color:"#FDF7F0"})},placeholder:"Select or add a company...",name:"company_name"}),L.company_name&&(0,d.jsxs)("p",{className:"error",children:["* ",L.company_name]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Email"}),(0,d.jsx)("input",{type:"email",name:"email",className:"input",value:S.email,onChange:E}),L.email&&(0,d.jsxs)("p",{className:"error",children:["* ",L.email]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Password"}),(0,d.jsx)("input",{type:F,name:"password",className:"password-input-register",value:S.password,onChange:E}),L.password&&(0,d.jsxs)("p",{className:"error",children:["* ",L.password]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Confirm password"}),(0,d.jsx)("input",{type:"password",name:"password_confirmation",className:"input",value:S.password_confirmation,onChange:E}),L.password_confirmation&&(0,d.jsxs)("p",{className:"error",children:["* ",L.password_confirmation]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Payment tier"}),(0,d.jsxs)("div",{className:"payment-array",children:[(0,d.jsx)("button",{className:"payment-button",onClick:()=>k({...S,tier:"Free"}),style:{backgroundColor:"Free"===S.tier?"#ED6B86":"#FDF7F0",color:"Free"===S.tier?"#FDF7F0":"#ED6B86"},children:"Free"}),(0,d.jsx)("button",{className:"payment-button",onClick:()=>k({...S,tier:"Lite"}),style:{backgroundColor:"Lite"===S.tier?"#ED6B86":"#FDF7F0",color:"Lite"===S.tier?"#FDF7F0":"#ED6B86"},children:"Lite"}),(0,d.jsx)("button",{className:"payment-button",onClick:()=>k({...S,tier:"Boost"}),style:{backgroundColor:"Boost"===S.tier?"#ED6B86":"#FDF7F0",color:"Boost"===S.tier?"#FDF7F0":"#ED6B86"},children:"Boost"}),(0,d.jsx)("button",{className:"payment-button",onClick:()=>k({...S,tier:"Elite"}),style:{backgroundColor:"Elite"===S.tier?"#ED6B86":"#FDF7F0",color:"Elite"===S.tier?"#FDF7F0":"#ED6B86"},children:"Elite"})]})]})]}),(0,d.jsx)("button",{type:"submit",onClick:async t=>{t.preventDefault(),n(!0),D({}),console.log("start register");const a={...L,first_name:S.first_name.length<1?"Add first name":"",last_name:S.last_name.length<1?"Add last name":"",company_name:S.company_name.length<1?"Add company":"",email:(0,s.isEmail)(S.email)?"":"Invalid email address"};D(a),console.log("checked register errors");if(Object.values(a).some((e=>""!==e)))n(!1);else{console.log("post register");try{const t=await o.Z.post("/api/auth/register/",S);if(t.data.checkout_session_id){const e=await(0,c.J)("pk_live_51O02bMBKPXWTORF2v4zeIPMCFzuSvlY6cJaKiStMAVm0cf9LvmMXhobEZ9VPbVVO9kGlfxTPtFkszZAfv10s3oG800dx3kYK7K"),{error:n}=await e.redirectToCheckout({sessionId:t.data.checkout_session_id});n&&(console.error("Stripe Checkout error:",n),D({...L,post:"Failed to initiate payment."}))}else try{const t=await o.Z.post("/api/auth/login/",{email:S.email,password:S.password});r=t.data.token,window.localStorage.setItem("wittle-user-token",r),window.localStorage.setItem("wittle-username",t.data.email),e("/agents/profile")}catch(i){console.error("Login error:",i),D({...L,post:"Login failed. Please check credentials."})}}catch(L){console.error("Registration error:",L),D({...L,post:"Registration failed. Please try again."})}finally{n(!1)}var r}},children:"Register"}),L.post&&(0,d.jsxs)("p",{className:"error",children:["* ",L.post]})]})]})})})}},74177:function(e,t,n){n(72791);var a=n(80184);t.Z=()=>(0,a.jsx)("div",{className:"loading-gif",children:(0,a.jsx)("img",{src:n(29193),alt:"loading gif"})})},69768:function(e,t,n){n.d(t,{Z:function(){return f}});var a=n(87462),o=n(72791),r=n(50241),s=n(8003),i=n(1413),l=n(42982),c=n(45987),d=n(22723),u=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],m=function(){var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=String(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase(),a=String(t.getOptionValue(e)).toLowerCase(),o=String(t.getOptionLabel(e)).toLowerCase();return a===n||o===n},p={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n,a){return!(!e||t.some((function(t){return m(e,t,a)}))||n.some((function(t){return m(e,t,a)})))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}};n(54164),n(51672);var f=(0,o.forwardRef)((function(e,t){var n=function(e){var t=e.allowCreateWhileLoading,n=void 0!==t&&t,a=e.createOptionPosition,s=void 0===a?"last":a,m=e.formatCreateLabel,f=void 0===m?p.formatCreateLabel:m,h=e.isValidNewOption,g=void 0===h?p.isValidNewOption:h,w=e.getNewOptionData,v=void 0===w?p.getNewOptionData:w,x=e.onCreateOption,j=e.options,F=void 0===j?[]:j,b=e.onChange,y=(0,c.Z)(e,u),C=y.getOptionValue,_=void 0===C?r.g:C,N=y.getOptionLabel,S=void 0===N?r.b:N,k=y.inputValue,L=y.isLoading,D=y.isMulti,E=y.value,P=y.name,O=(0,o.useMemo)((function(){return g(k,(0,d.H)(E),F,{getOptionValue:_,getOptionLabel:S})?v(k,f(k)):void 0}),[f,v,S,_,k,g,F,E]),Z=(0,o.useMemo)((function(){return!n&&L||!O?F:"first"===s?[O].concat((0,l.Z)(F)):[].concat((0,l.Z)(F),[O])}),[n,s,L,O,F]),A=(0,o.useCallback)((function(e,t){if("select-option"!==t.action)return b(e,t);var n=Array.isArray(e)?e:[e];if(n[n.length-1]!==O)b(e,t);else if(x)x(k);else{var a=v(k,k),o={action:"create-option",name:P,option:a};b((0,d.D)(D,[].concat((0,l.Z)((0,d.H)(E)),[a]),a),o)}}),[v,k,D,P,O,x,b,E]);return(0,i.Z)((0,i.Z)({},y),{},{options:Z,onChange:A})}((0,s.u)(e));return o.createElement(r.S,(0,a.Z)({ref:t},n))}))},29193:function(e,t,n){e.exports=n.p+"static/media/transparent-spinner.f3eb62caffaa8568ecbe.gif"},27112:function(e,t,n){n.d(t,{J:function(){return f}});var a,o="https://js.stripe.com/v3",r=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,s="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",i=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(o).concat(t);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},l=null,c=null,d=null,u=function(e){return null!==l?l:(l=new Promise((function(t,n){if("undefined"!==typeof window&&"undefined"!==typeof document)if(window.Stripe&&e&&console.warn(s),window.Stripe)t(window.Stripe);else try{var a=function(){for(var e=document.querySelectorAll('script[src^="'.concat(o,'"]')),t=0;t<e.length;t++){var n=e[t];if(r.test(n.src))return n}return null}();if(a&&e)console.warn(s);else if(a){if(a&&null!==d&&null!==c){var l;a.removeEventListener("load",d),a.removeEventListener("error",c),null===(l=a.parentNode)||void 0===l||l.removeChild(a),a=i(e)}}else a=i(e);d=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,n),c=function(e){return function(){e(new Error("Failed to load Stripe.js"))}}(n),a.addEventListener("load",d),a.addEventListener("error",c)}catch(u){return void n(u)}else t(null)}))).catch((function(e){return l=null,Promise.reject(e)}))},m=!1,p=function(){return a||(a=u(null).catch((function(e){return a=null,Promise.reject(e)})))};Promise.resolve().then((function(){return p()})).catch((function(e){m||console.warn(e)}));var f=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];m=!0;var a=Date.now();return p().then((function(e){return function(e,t,n){if(null===e)return null;var a=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"3.2.0",startTime:t})}(a,n),a}(e,t,a)}))}}}]);
//# sourceMappingURL=710.5f1b19da.chunk.js.2f7d82ef1eab.map