"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[687],{23687:function(e,s,t){t.r(s),t.d(s,{default:function(){return F}});var a=t(72791),i=t(31243),n=t(57689),l=t(97165),c=(t(99696),t(24604),t(60764)),r=t(52094),o=t(78084),d=t(67842),h=t(33377),u=t(16409),m=t(59394),p=t(25423),g=t(84487),x=t(53300),j=t(7122),k=t(71213),y=t(39577),b=t(38040),v=t(20264),_=t(82213),w=t(92514),N=t(32767),f=t(19832),M=t(80184);var S=e=>{let{addressSubstring:s,postcodeSubstring:t,listingFields:i,postcodeData:n,topPrimaries:l,topSecondaries:c,restaurants1:r,cuisines:o,topRestaurants:d,gyms1:h,mainGyms:S,supermarkets1:F,mainSupermarkets:D,pubs1:C,topPubs:P,tubes1:T,trains1:E,setInsightView:Z,primaryData1:I,setPrimaryData1:R,secondaryData1:B,setSecondaryData1:q,setTubes1:L,setRestaurants1:V,setPubs1:A,setSupermarkets1:$,setGyms1:U,ev1:O,setEv1:G}=e;const[z,Y]=(0,a.useState)("Overview"),[W,H]=(0,a.useState)(),[J,X]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[ee,se]=(0,a.useState)(!1),[te,ae]=(0,a.useState)(!1),[ie,ne]=(0,a.useState)("Primary schools"),[le,ce]=(0,a.useState)("Table");return(0,a.useEffect)((()=>{n&&(()=>{const e=Math.ceil((1-n[0].crime[0].percentile+n[0].ev.percentile+n[0].fitness.percentile+(1-n[0].parks_lsoa[0].london_percentile/100)+n[0].restaurants.normal_percentile+n[0].supermarkets.percentile+n[0].tubes.percentile)/7*100);H(e)})()})),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("section",{className:"insights-results-wrapper",children:[(0,M.jsxs)("section",{className:"insights-navigation",children:[(0,M.jsx)("div",{className:"direction-arrow",onClick:()=>Z("Search")}),(0,M.jsxs)("div",{className:"navigation-input",children:[(0,M.jsx)("h3",{className:"title",children:"Postcode"}),(0,M.jsx)("h3",{className:"result",children:t})]}),(0,M.jsxs)("div",{className:"navigation-input",children:[(0,M.jsx)("h3",{className:"title",children:"Address"}),(0,M.jsx)("h3",{className:"result",children:s})]}),(0,M.jsxs)("div",{className:"navigation-input",children:[(0,M.jsx)("h3",{className:"title",children:"Channel"}),(0,M.jsx)("h3",{className:"result",children:i.channel})]})]}),(0,M.jsxs)("section",{className:"property-insights-wrapper",children:[(0,M.jsxs)("div",{className:"property-insight-nav",children:[(0,M.jsxs)("div",{className:"property-insight-buttons",children:[(0,M.jsx)("h3",{className:"insight-button "+("Overview"===z?"active":"inactive"),id:"left",onClick:()=>Y("Overview"),children:"Property overview"}),(0,M.jsx)("h3",{className:"insight-button "+("Details"===z?"active":"inactive"),id:"right",onClick:()=>Y("Details"),children:"Property details"})]}),(0,M.jsxs)("div",{className:"print-section",children:[(0,M.jsx)("div",{className:"print-icon"}),(0,M.jsx)("h3",{children:"Print"})]})]}),"Overview"===z?(0,M.jsxs)("div",{className:"insight-dropdowns",children:[(0,M.jsxs)("div",{className:"summary-header",children:[(0,M.jsx)("h3",{children:"Property Summary"}),(0,M.jsx)("hr",{className:"header-line"})]}),(0,M.jsx)(u.Z,{neighbourhoodScore:W,postcodeData:n}),(0,M.jsxs)("div",{className:"summary-header",onClick:()=>X(!J),children:[(0,M.jsx)("h3",{children:"School highlights"}),(0,M.jsx)("hr",{className:"header-line"})]}),J?(0,M.jsx)(m.Z,{topPrimaries:l,topSecondaries:c}):"",(0,M.jsxs)("div",{className:"summary-header",onClick:()=>Q(!K),children:[(0,M.jsx)("h3",{children:"Lifestyle highlights"}),(0,M.jsx)("hr",{className:"header-line"})]}),K?(0,M.jsx)(p.Z,{restaurants1:r,cuisines:o,topRestaurants:d,gyms1:h,mainGyms:S,supermarkets1:F,mainSupermarkets:D,pubs1:C,topPubs:P}):"",(0,M.jsxs)("div",{className:"summary-header",onClick:()=>se(!ee),children:[(0,M.jsx)("h3",{children:"Transport highlights"}),(0,M.jsx)("hr",{className:"header-line"})]}),ee?(0,M.jsx)(g.Z,{postcodeData:n,tubes1:T,trains1:E}):"",(0,M.jsxs)("div",{className:"summary-header",onClick:()=>ae(!te),children:[(0,M.jsx)("h3",{children:"Neighbourhoood highlights"}),(0,M.jsx)("hr",{className:"header-line"})]}),te?(0,M.jsx)(x.Z,{postcodeData:n}):""]}):"Details"===z?(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{className:"property-details-wrapper",children:[(0,M.jsx)(j.Z,{sliderSelection:ie,setSliderSelection:ne}),(0,M.jsxs)("div",{className:"detail-table-title",children:[(0,M.jsxs)("h3",{children:[ie," list"]}),(0,M.jsx)("hr",{className:"table-title-line"}),(0,M.jsx)("input",{placeholder:"Explore the data"}),(0,M.jsx)("div",{className:"icon-box "+("Table"===le?"active":"inactive"),onClick:()=>ce("Table"),children:(0,M.jsx)("div",{className:"icon",id:"table"})}),(0,M.jsx)("div",{className:"icon-box "+("Map"===le?"active":"inactive"),onClick:()=>ce("Map"),children:(0,M.jsx)("div",{className:"icon",id:"map"})})]}),(0,M.jsx)("div",{className:"insight-tables",children:"Primary schools"===ie?(0,M.jsx)(k.Z,{primaryData1:I,setPrimaryData1:R,postcodeData:n,tableMapView:le,listType:"short list"}):"Secondary schools"===ie?(0,M.jsx)(y.Z,{secondaryData1:B,setSecondaryData1:q,postcodeData:n,tableMapView:le,listType:"short list"}):"Tubes"===ie?(0,M.jsx)(b.Z,{tubes1:T,setTubes1:L,listType:"short list",postcodeData:n,tableMapView:le}):"Restaurants"===ie?(0,M.jsx)(v.Z,{restaurants1:r,setRestaurants1:V,listType:"short list",postcodeData:n,tableMapView:le}):"Pubs"===ie?(0,M.jsx)(_.Z,{pubs1:C,setPubs1:A,listType:"short list",postcodeData:n,tableMapView:le}):"Supermarkets"===ie?(0,M.jsx)(w.Z,{supermarkets1:F,setSupermarkets1:$,listType:"short list",postcodeData:n,tableMapView:le}):"Fitness"===ie?(0,M.jsx)(N.Z,{gyms1:h,setGyms1:U,listType:"short list",postcodeData:n,tableMapView:le}):"EVs"===ie?(0,M.jsx)(f.Z,{ev1:O,setEv1:G,listType:"short list",postcodeData:n,tableMapView:le}):""})]})}):""]})]})})};i.Z.defaults.xsrfCookieName="csrftoken",i.Z.defaults.xsrfHeaderName="X-CSRFToken";var F=()=>{const e=(0,n.s0)(),[s,t]=(0,a.useState)(),[u,m]=(0,a.useState)(),[p,g]=(0,a.useState)(),x=(0,a.useRef)(null),[j,k]=(0,a.useState)(!1),[y,b]=(0,a.useState)("Listing generator"),[v,_]=(0,a.useState)("Listing generator"),[w,N]=(0,a.useState)("Search"),[f,F]=(0,a.useState)("Property insights"),[D,C]=(0,a.useState)(""),[P,T]=(0,a.useState)(""),[E,Z]=(0,a.useState)({postcode:"",address:"",description:"",channel:"",bedrooms:"",bathrooms:"",property_type:"",tenure:"",size:"",on_road_parking:"",off_road_parking:"",balcony:"",primary_schools:0,secondary_schools:0,tubes:0,trains:0,restaurants:0,pubs:0,supermarkets:0,gyms:0,parks:0,evs:0,crime:0}),[I,R]=(0,a.useState)({location:"",size:"",property_type:"",bedrooms:"",bathrooms:"",en_suites:"",amenities:[],channel:"",additional_info:"",price:"",restaurants:"",pubs:"",supermarkets:"",tube:"",trains:"",parks:"",evs:"",primary_schools:"",secondary_schools:"",gyms:""}),[B,q]=(0,a.useState)(),[L,V]=(0,a.useState)(),[A,$]=(0,a.useState)(),[U,O]=(0,a.useState)(),[G,z]=(0,a.useState)(),[Y,W]=(0,a.useState)(),[H,J]=(0,a.useState)(),[X,K]=(0,a.useState)(),[Q,ee]=(0,a.useState)(),[se,te]=(0,a.useState)(),[ae,ie]=(0,a.useState)(),[ne,le]=(0,a.useState)(),[ce,re]=(0,a.useState)(),[oe,de]=(0,a.useState)(),[he,ue]=(0,a.useState)(),[me,pe]=(0,a.useState)(),[ge,xe]=(0,a.useState)(),[je,ke]=(0,a.useState)(),[ye,be]=(0,a.useState)([]),[ve,_e]=(0,a.useState)([]),[we,Ne]=(0,a.useState)([]),[fe,Me]=(0,a.useState)([]),[Se,Fe]=(0,a.useState)(),[De,Ce]=(0,a.useState)(),[Pe,Te]=(0,a.useState)(),[Ee,Ze]=(0,a.useState)(),[Ie,Re]=(0,a.useState)(),[Be,qe]=(0,a.useState)(!1),[Le,Ve]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(0,l.Hb)()?(async()=>{try{const{data:e}=await i.Z.get(`/api/auth/profile/${(0,l.Nh)()}/`,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});m(e)}catch(e){t(!0),console.log(e)}})():(e("/access-denied"),console.log("no account"))}),[]);const Ae=async e=>{try{"listing_ai_total"===e&&qe(!1);const{data:s}=await i.Z.post("/api/postcodes/",{postcode:D});if(console.log("postcode data ->",s),q(s),He(e),"listing_ai_total"===e&&Ve(!0),"listing_insight_total"===e){const e={...E,postcode:D,request_type:"Insights"};await i.Z.post("/api/listing_favourites/",e,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});$e()}if("listing_normal_total"===e){const e={...E,postcode:D,request_type:"Listing"};await i.Z.post("/api/listing_favourites/",e,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}})}}catch(s){t(!0),console.log(s)}},$e=e=>{window.localStorage.setItem("listing-postcode",JSON.stringify(D))};(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/primaries/");V(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);const Ue=20/60*5,Oe=6371,Ge=e=>e*Math.PI/180,ze=5/60;(0,a.useEffect)((()=>{L&&(()=>{const e=L.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;e.distance_between=n,e.walkTimeMin=Math.round(n/ze);const l=n/e.max_distance;return"Independent school"===e.school_type||"Special school"===e.school_type||"On request"===e.max_distance?e.within_catchment="N/a":"Based on map"===e.additional_status?e.within_catchment="Check catchment map":"Religion"===e.max_distance&e.distance_between<.6?e.within_catchment="Very likely if religious critera met":"Religion"===e.max_distance&e.distance_between<.8?e.within_catchment="Likely if religious critera met":"Religion"===e.max_distance&e.distance_between<1?e.within_catchment="Probably if religious critera met":"Religion"===e.max_distance&e.distance_between<1.5?e.within_catchment="Unlikely, even if religious critera met":"Religion"===e.max_distance&e.distance_between>1.5?e.within_catchment="Very unlikely, even if religious critera met":"Not specified"===e.max_distance&e.distance_between<.4?e.within_catchment="Very likely but no distance specified":"Not specified"===e.max_distance&e.distance_between<.7?e.within_catchment="Likely but no distance specified":"Not specified"===e.max_distance&e.distance_between<1?e.within_catchment="Probably but no distance specified":"Not specified"===e.max_distance&e.distance_between>1?e.within_catchment="Unlikely, but no distance specified":null===e.max_distance&e.distance_between<.6?e.within_catchment="Very likely, but no distance data available":null===e.max_distance&e.distance_between<.8?e.within_catchment="Likely, but no distance data available":null===e.max_distance&e.distance_between<1?e.within_catchment="Probably, but no distance data available":null===e.max_distance&e.distance_between<1.5?e.within_catchment="Unlikely, but no distance data available":null===e.max_distance&e.distance_between>1.5?e.within_catchment="Very unlikely, but no distance data available":l<=.6?e.within_catchment="Yes":l<=.8?e.within_catchment="Very likely":l<=1?e.within_catchment="Probably":l<=1.2?e.within_catchment="Probably not":"Does not apply"===e.max_distance?e.within_catchment="Yes":e.within_catchment="No",n<=Ue})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin)),s=e.slice(0,8);W(s),$(e),console.log("nearby primaries ->",e)})()}),[L]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/secondaries/");O(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{U&&(()=>{const e=U.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;e.distance_between=n,e.walkTimeMin=Math.round(n/ze);const l=n/e.max_distance,c=n/e.min_distance;return e.school_type.includes("independent")||e.school_type.includes("special")?e.within_catchment="N/a":"Exam"===e.max_distance||"Test score"===e.max_distance?e.within_catchment="Dependent on test results":"Random"===e.max_distance?e.within_catchment="Random selection based on performance":"Catchment score"===e.max_distance?e.within_catchment="School uses catchment score - check":"Based on map"===e.max_distance?e.within_catchment="Check catchment map":"Religion"===e.max_distance&e.distance_between<.7?e.within_catchment="Very likely if religious critera met":"Religion"===e.max_distance&e.distance_between<.9?e.within_catchment="Likely if religious critera met":"Religion"===e.max_distance&e.distance_between<1.5?e.within_catchment="Probably if religious critera met":"Religion"===e.max_distance&e.distance_between>1.5?e.within_catchment="Unlikely, even if religious critera met":"Does not apply"===e.max_distance||null!==e.min_distance&c<=1?e.within_catchment="Yes":null!==e.min_distance&l<=.5?e.within_catchment="Very likely":null!==e.min_distance&l<=.7?e.within_catchment="Probably":e.within_catchment=l<=.6?"Yes":l<=.8?"Very likely":l<=1?"Probably":l<=1.2?"Probably not":"No",n<=2.5})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin)),s=e.slice(0,8);J(s),z(e)})()}),[U]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/restaurants/");K(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);const Ye=1.25;(0,a.useEffect)((()=>{X&&(()=>{const e=X.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=Ye})).sort(((e,s)=>s.rating-e.rating)),s=e.filter((e=>"No Cuisine Data"!==e.cuisine)).slice(0,3).map((e=>e.restaurant_name));ke((e=>new Set(e.map((e=>e.cuisine))).size)(e)),re(e),be(s),1===E.restaurants&&R((s=>({...s,restaurants:`${e.length} restaurants within 15 min walk, with more than ${je} cuisines available`})))})()}),[X]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/gyms/");ee(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{Q&&(()=>{const e=["third space","pure gym","1 rebel","virgin","barry's","the gym group"],s=new Set,t=Q.filter((e=>{const s=Ge(parseFloat(e.Lat)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.long)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.Lat)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=Ye})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin)),a=[];for(let i=0;i<t.length;i++){const n=t[i];if(n.gym_group&&e.includes(n.gym_group.toLowerCase())&&!s.has(n.gym_group)&&(a.push(n.gym_group),s.add(n.gym_group),3===a.length))break}de(t),Ne(a),1===E.gyms&&R((e=>({...e,gyms:`${t.length} gyms within 15 min walk, including ${a[0]} and  ${a[1]}`})))})()}),[Q]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/supermarkets/");ie(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{ae&&(()=>{const e=["m&s","waitrose","aldi","lidl","sainsburys","tesco","asda"],s=new Set,t=ae.map((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),{...e,distance:n}})).filter((e=>e.distance<=Ye)),a=[];for(let i=0;i<t.length;i++){const n=t[i];if(e.includes(n.supermarket_brand.toLowerCase())&&!s.has(n.supermarket_brand)&&(a.push(n.supermarket_brand),s.add(n.supermarket_brand),3===a.length))break}pe(t),Me(a),1===E.supermarkets&&R((e=>({...e,supermarkets:`${t.length} supermarkets within 15 min walk, including ${a[0]} and ${a[1]}`})))})()}),[ae]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/tubes/");Fe(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{Se&&(()=>{const e=Se.filter((e=>{const s=Ge(parseFloat(e.lat)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.long)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.lat)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=Ue})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin));Te(e),console.log("Nearby tubes ->",e),1===E.tubes&&R((s=>({...s,tubes:`${e.length} within 15 min walk, including ${e[0].station_name} and ${e[1].station_name}`})))})()}),[Se]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/evs/");le(e);const s=e.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=.8333333333333333})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin));xe(s)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/pubs/");te(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{se&&(()=>{const e=se.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=Ye})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin)),s=e.slice(0,3).map((e=>e.name));ue(e),_e(s)})()}),[se]);(0,a.useEffect)((()=>{B&&(()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/trains/");Ce(e)})()}catch(e){t(!0),console.log(e)}})()}),[B]);(0,a.useEffect)((()=>{De&&(()=>{const e=De.filter((e=>{const s=Ge(parseFloat(e.latitude)-parseFloat(B[0].longitude)),t=Ge(parseFloat(e.longitude)-parseFloat(B[0].latitude)),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(Ge(parseFloat(B[0].longitude)))*Math.cos(Ge(parseFloat(e.latitude)))*Math.sin(t/2)*Math.sin(t/2),i=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),n=Oe*i;return e.distance_between=n,e.walkTimeMin=Math.round(n/ze),n<=Ue})).sort(((e,s)=>e.walkTimeMin-s.walkTimeMin));Ze(e)})()}),[De]);const We=e=>{Z((s=>({...s,[e]:1===s[e]?0:1})))},He=async e=>{try{const{data:s}=await i.Z.post("/api/usage/listing/",{column:e},{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log(s),s.status}catch(s){console.error("Error:",s)}};return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("section",{className:"agent-profile-page",children:[(0,M.jsx)("div",{className:"desktop-nav",children:(0,M.jsx)(c.Z,{navbarColour:"#FDF7F0"})}),(0,M.jsx)("div",{className:"mobile-nav",children:(0,M.jsx)(o.Z,{setProfileContent:b,profileContent:y,profileDetail:v,setProfileDetail:_})}),(0,M.jsx)(r.Z,{setProfileDetail:_,setProfileContent:b,userData:u}),(0,M.jsx)("section",{className:"main-body",style:{height:"Results"===w?"auto":"none",marginTop:"Results"===w?"3%":"none"},children:(0,M.jsx)("section",{className:"main-body-details",children:(0,M.jsxs)("section",{className:"listing-generator",children:[(0,M.jsxs)("div",{className:"listing-options",children:[(0,M.jsxs)("div",{className:"listing-buttons",children:[(0,M.jsx)("h5",{className:"no-print",onClick:()=>F("Property insights"),style:{borderBottom:"Property insights"===f?"3px solid #ED6B86":"none",textUnderlineOffset:"Property insights"===f?"0.5em":"initial",fontWeight:"Property insights"===f?"700":"400"},children:"Property insights"}),(0,M.jsx)("h5",{className:"no-print",onClick:()=>F("Listing generator"),style:{borderBottom:"Listing generator"===f?"3px solid #ED6B86":"none",textUnderlineOffset:"Listing generator"===f?"0.5em":"initial",fontWeight:"Listing generator"===f?"700":"400"},children:"Listing generator"}),(0,M.jsx)("h5",{className:"no-print",onClick:()=>F("AI listing generator"),style:{borderBottom:"AI listing generator"===f?"3px solid #ED6B86":"none",textUnderlineOffset:"AI listing generator"===f?"0.5em":"initial",fontWeight:"AI listing generator"===f?"700":"400"},children:"AI listing generator"})]}),(0,M.jsx)("div",{className:"logout-button",onClick:s=>{localStorage.removeItem("wittle-user-token"),localStorage.removeItem("wittle-username"),e("/login")},children:(0,M.jsx)("div",{className:"logout-icon"})})]}),(0,M.jsx)("hr",{className:"title-line"}),"Property insights"===f&&u&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<101)?(0,M.jsx)(M.Fragment,{children:"Search"===w?(0,M.jsx)("div",{className:"basic-listing-wrapper",children:(0,M.jsxs)("div",{className:"property-insight-inputs",children:[(0,M.jsx)("h3",{className:"insight-title",children:"Insert full postcode to extract details about property"}),(0,M.jsxs)("div",{className:"double-input-block",children:[(0,M.jsxs)("div",{className:"input-block small",children:[(0,M.jsx)("h3",{children:"Postcode"}),(0,M.jsx)("input",{type:"text",value:D,onChange:e=>C(e.target.value.toUpperCase().replace(/\s+/g,"")),placeholder:"Enter postcode"})]}),(0,M.jsxs)("div",{className:"input-block medium",children:[(0,M.jsx)("h3",{children:"Address"}),(0,M.jsx)("input",{type:"text",value:P,onChange:e=>{const s=e.target.value;T(s),Z((e=>({...e,address:s})))},placeholder:"Enter address"})]})]}),(0,M.jsxs)("div",{className:"input-block large",children:[(0,M.jsx)("h3",{children:"Channel"}),(0,M.jsxs)("select",{className:"listing-dropdown",onChange:e=>Z((s=>({...s,channel:e.target.value}))),children:[(0,M.jsx)("option",{children:"--- Select ---"}),(0,M.jsx)("option",{children:"Sales"}),(0,M.jsx)("option",{children:"Rental"})]})]}),(0,M.jsx)("div",{className:"search-section",children:(0,M.jsx)("button",{className:"load-insights",onClick:()=>{Ae("listing_insight_total"),Z((e=>({...e,request_type:"insights"}))),N("Results")},children:"See insights"})})]})}):"Results"===w?(0,M.jsx)(S,{postcodeSubstring:D,addressSubstring:P,listingFields:E,postcodeData:B,topPrimaries:Y,topSecondaries:H,restaurants1:ce,cuisines:je,topRestaurants:ye,setRestaurants1:re,gyms1:oe,setGyms1:de,mainGyms:we,supermarkets1:me,setSupermarkets1:pe,mainSupermarkets:fe,pubs1:he,topPubs:ve,tubes1:Pe,setTubes1:Te,trains1:Ee,insightView:w,setInsightView:N,primaryData1:A,setPrimaryData1:$,secondaryData1:G,setSecondaryData1:z,ev1:ge,setEv1:xe}):""}):"Listing generator"===f&&u&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<101)?(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("div",{className:"full-listing-wrapper",children:[(0,M.jsx)("div",{className:"full-listing-inputs",children:(0,M.jsxs)("div",{className:"property-insight-inputs",children:[(0,M.jsx)("h3",{className:"insight-title",children:"Input details and select features you want to include in your listing"}),(0,M.jsxs)("div",{className:"double-input-block",children:[(0,M.jsxs)("div",{className:"input-block small",children:[(0,M.jsx)("h3",{children:"Postcode"}),(0,M.jsx)("input",{type:"text",value:D,onChange:e=>C(e.target.value.toUpperCase().replace(/\s+/g,"")),placeholder:"Enter postcode..."})]}),(0,M.jsxs)("div",{className:"input-block medium",children:[(0,M.jsx)("h3",{children:"Address"}),(0,M.jsx)("input",{type:"text",value:P,onChange:e=>{const s=e.target.value;T(s),Z((e=>({...e,address:s})))},placeholder:"Enter address"})]})]}),(0,M.jsx)("div",{className:"single-input-block",children:(0,M.jsxs)("div",{className:"input-block large",children:[(0,M.jsx)("h3",{children:"Channel"}),(0,M.jsxs)("select",{className:"listing-dropdown",onChange:e=>Z((s=>({...s,channel:e.target.value}))),children:[(0,M.jsx)("option",{children:"--- Select ---"}),(0,M.jsx)("option",{children:"Sales"}),(0,M.jsx)("option",{children:"Rental"})]})]})}),(0,M.jsx)("div",{className:"single-input-block",children:(0,M.jsxs)("div",{className:"input-block large",children:[(0,M.jsx)("h3",{children:"Description"}),(0,M.jsx)("textarea",{id:"description",value:E.description,rows:"4",placeholder:"Enter description",onChange:e=>Z((s=>({...s,description:e.target.value})))})]})}),(0,M.jsxs)("div",{className:"lifestyle-input-block",children:[(0,M.jsx)("h3",{className:"insight-title",children:"Lifestyle elements to include"}),(0,M.jsxs)("div",{className:"lifestyle-input-wrap",children:[(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"primaries"}),(0,M.jsx)("h3",{children:"Primary schools"}),(0,M.jsx)(d.Z,{checked:1===E.primary_schools,onChange:()=>We("primary_schools"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"secondaries"}),(0,M.jsx)("h3",{children:"Secondary schools"}),(0,M.jsx)(d.Z,{checked:1===E.secondary_schools,onChange:()=>We("secondary_schools"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"tubes"}),(0,M.jsx)("h3",{children:"Tubes"}),(0,M.jsx)(d.Z,{checked:1===E.tubes,onChange:()=>We("tubes"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"trains"}),(0,M.jsx)("h3",{children:"Trains"}),(0,M.jsx)(d.Z,{checked:1===E.trains,onChange:()=>We("trains"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"evs"}),(0,M.jsx)("h3",{children:"Electric vehicles"}),(0,M.jsx)(d.Z,{checked:1===E.evs,onChange:()=>We("evs"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"restaurants"}),(0,M.jsx)("h3",{children:"Restaurants"}),(0,M.jsx)(d.Z,{checked:1===E.restaurants,onChange:()=>We("restaurants"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"pubs"}),(0,M.jsx)("h3",{children:"Pubs"}),(0,M.jsx)(d.Z,{checked:1===E.pubs,onChange:()=>We("pubs"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"parks"}),(0,M.jsx)("h3",{children:"Parks"}),(0,M.jsx)(d.Z,{checked:1===E.parks,onChange:()=>We("parks"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"gyms"}),(0,M.jsx)("h3",{children:"Gyms"}),(0,M.jsx)(d.Z,{checked:1===E.gyms,onChange:()=>We("gyms"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"supermarkets"}),(0,M.jsx)("h3",{children:"Supermarkets"}),(0,M.jsx)(d.Z,{checked:1===E.supermarkets,onChange:()=>We("supermarkets"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]}),(0,M.jsxs)("div",{className:"input-block-icons",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"crime"}),(0,M.jsx)("h3",{children:"Crime"}),(0,M.jsx)(d.Z,{checked:1===E.crime,onChange:()=>We("crime"),onColor:"#ED6B86",offColor:"#D5D5D5",uncheckedIcon:null,checkedIcon:null})]})]})]}),(0,M.jsx)("div",{className:"listing-search-section",children:(0,M.jsx)("button",{className:"load-insights",onClick:()=>Ae("listing_normal_total"),children:"Load description"})})]})}),(0,M.jsxs)("section",{className:"full-listing-outputs",children:[(0,M.jsxs)("div",{className:"results-header",children:[(0,M.jsx)("div",{className:"header-text",children:(0,M.jsx)("h3",{className:"results-title",children:"Your listing"})}),(0,M.jsx)("div",{className:"header-cta",children:(0,M.jsxs)("div",{className:"copy-button",onClick:()=>{const e=x.current.innerText,s=document.createElement("textarea");s.value=e,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s)},children:[(0,M.jsx)("div",{className:"copy-icon"}),(0,M.jsx)("h3",{children:"Copy"})]})})]}),(0,M.jsxs)("div",{className:"results-section",ref:x,children:[(0,M.jsx)("div",{className:"results-description",children:B&&""!==E.description?(0,M.jsx)("h3",{children:E.description}):""}),B?(0,M.jsx)("h3",{className:"results-sub-title",children:"What you should know about this area"}):"",ce&&1===E.restaurants?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"restaurants"}),(0,M.jsx)("h3",{children:"Restaurants"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[ce.length," restaurants within 15 mins walk"]}),(0,M.jsxs)("li",{children:["more than ",je," cuisines available"]}),(0,M.jsxs)("li",{children:[ye[0],", ",ye[1]," & ",ye[2]," are well rated"]})]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",he&&1===E.pubs?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"pubs"}),(0,M.jsx)("h3",{children:"Pubs"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[he.length," pubs within 15 mins walk"]}),(0,M.jsxs)("li",{children:[ve[0],", ",ve[1]," & ",ve[2]," are well rated"]})]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",A&&1===E.primary_schools?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"primaries"}),(0,M.jsx)("h3",{children:"Primary schools"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("ul",{className:"results-details",children:A.slice(0,5).map(((e,s)=>(0,M.jsxs)("li",{children:[e.school_name," - ",e.ofsted_results," ofsted - ",e.walkTimeMin," mins walk"]},s)))})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",G&&1===E.secondary_schools?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"secondaries"}),(0,M.jsx)("h3",{children:"Secondary schools"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("ul",{className:"results-details",children:G.slice(0,5).map(((e,s)=>(0,M.jsxs)("li",{children:[e.school_name," - ",e.ofsted_results," ofsted - ",e.walkTimeMin," mins walk"]},s)))})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",oe&&1===E.gyms?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"gyms"}),(0,M.jsx)("h3",{children:"Gyms"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[oe.length," gyms within 15 mins walk"]}),3===we.length?(0,M.jsxs)("li",{children:["includes ",we[0],", ",we[1]," & ",we[2]]}):2===we.length?(0,M.jsxs)("li",{children:["includes ",we[0]," & ",we[1]," "]}):1===we.length?(0,M.jsxs)("li",{children:["includes ",we[0]]}):""]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",me&&1===E.supermarkets?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"supermarkets"}),(0,M.jsx)("h3",{children:"Supermarkets"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:["\ud83d\uded2 ",me.length," supermarkets within 15 mins walk"]}),3===fe.length?(0,M.jsxs)("li",{children:["\ud83d\uded2 includes ",fe[0],", ",fe[1]," & ",fe[2]]}):2===fe.length?(0,M.jsxs)("li",{children:["\ud83d\uded2 includes ",fe[0]," & ",fe[1]," "]}):1===fe.length?(0,M.jsxs)("li",{children:["\ud83d\uded2 includes ",fe[0]]}):""]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",Pe&&1===E.tubes?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"tubes"}),(0,M.jsx)("h3",{children:"Tubes"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[Pe.length," stations within 20 mins walk"]}),Pe.slice(0,3).map(((e,s)=>(0,M.jsxs)("li",{children:[e.station_name," - ",e.line," - ",e.walkTimeMin," mins walk"]},s)))," "]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",Ee&&1===E.trains?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"trains"}),(0,M.jsx)("h3",{children:"Trains"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[Ee.length," stations within 20 mins walk"]}),Ee.slice(0,3).map(((e,s)=>(0,M.jsxs)("li",{children:[e.station," - ",e.walkTimeMin," mins walk"]},s)))]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",B&&1===E.parks?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"parks"}),(0,M.jsx)("h3",{children:"Parks"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:["within top ",100-B[0].parks_lsoa[0].london_percentile,"% of areas in london for access to greenspace"]}),(0,M.jsxs)("li",{children:[B[0].parks_postcode.park_name0," - ",Math.ceil(B[0].parks_postcode.distance0/1e3/5*60)," mins walk"]}),(0,M.jsxs)("li",{children:[B[0].parks_postcode.park_name1," - ",Math.ceil(B[0].parks_postcode.distance1/1e3/5*60)," mins walk"]}),(0,M.jsxs)("li",{children:[B[0].parks_postcode.park_name2," - ",Math.ceil(B[0].parks_postcode.distance2/1e3/5*60)," mins walk"]})]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):"",ge&&1===E.evs?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"results-block",children:[(0,M.jsxs)("div",{className:"result-block-header",children:[(0,M.jsx)("div",{className:"lifestyle-icon",id:"evs"}),(0,M.jsx)("h3",{children:"Electric vehicle charging"})]}),(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)("ul",{className:"results-details",children:[(0,M.jsxs)("li",{children:[B[0].ev.ev_10_mins," charging points within 10 mins walk"]}),(0,M.jsxs)("li",{children:["in the top ",Math.round(100*(1-B[0].ev.percentile)),"% of areas in London for ev charging access"]})]})})]}),(0,M.jsx)("hr",{className:"results-divider"})]}):""]})]})]})}):"AI listing generator"===f&&u&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].listing_monthly_count<101)?(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(h.default,{})}):""]})})})]})})}}}]);
//# sourceMappingURL=687.aa7828bc.chunk.js.map