"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[453,85],{4177:function(e,s,t){t(2791);var a=t(184);s.Z=()=>(0,a.jsx)("div",{className:"loading-gif",children:(0,a.jsx)("img",{src:t(7837),alt:"loading gif"})})},4604:function(e,s,t){t(2791),t(184)},4453:function(e,s,t){t.r(s);var a=t(2791),l=t(5294),i=t(7689),c=t(7165),n=(t(9696),t(4604),t(764)),r=t(2094),o=t(8084),d=t(4177),h=t(184);l.Z.defaults.xsrfCookieName="csrftoken",l.Z.defaults.xsrfHeaderName="X-CSRFToken";s.default=()=>{const e=(0,i.s0)(),[s,t]=(0,a.useState)(),[u,g]=(0,a.useState)(),[m,x]=(0,a.useState)(),[p,j]=(0,a.useState)(!1),[v,f]=(0,a.useState)("Comparison"),[N,y]=(0,a.useState)("Comparison"),[b,k]=(0,a.useState)(!1),[_,C]=(0,a.useState)(""),[S,E]=(0,a.useState)(""),[w,P]=(0,a.useState)(),[F,Z]=(0,a.useState)(),[A,B]=(0,a.useState)([]),[D,R]=(0,a.useState)([]),[$,z]=(0,a.useState)(""),[H,I]=(0,a.useState)("Efficiency"),[L,U]=(0,a.useState)([]),[T,W]=(0,a.useState)(sessionStorage.getItem("sessionName")||"");(0,a.useEffect)((()=>{(0,c.Hb)()?(async()=>{try{const{data:e}=await l.Z.get(`/api/auth/profile/${(0,c.Nh)()}/`,{headers:{Authorization:`Bearer ${(0,c.hP)()}`}});console.log("user data ->",e),g(e)}catch(e){t(!0),console.log(e)}})():(e("/access-denied"),console.log("no account"))}),[]);const Y=async()=>{if((0,c.Hb)()){console.log("trying to increase");try{const{data:e}=await l.Z.post("/api/usage/",{},{headers:{Authorization:`Bearer ${(0,c.hP)()}`}});console.log(e),"success"===e.status?console.log("Usage count increased successfully"):console.error("Failed to increase usage count:",e.message)}catch(s){console.error("Error:",s)}}else e("/access-denied"),console.log("logged out")};function q(e){return L.some((s=>s.postcode===e.postcode&&s.address===e.address))}(0,a.useEffect)((()=>{(async()=>{try{const{data:e}=await l.Z.get("/api/epc_favourite/",{headers:{Authorization:`Bearer ${(0,c.hP)()}`}});U(e)}catch(e){console.error("Error fetching favourites:",e)}})()}),[]),(0,a.useEffect)((()=>{T&&sessionStorage.setItem("sessionName",T)}),[T]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("section",{className:"agent-profile-page",children:[(0,h.jsx)("div",{className:"desktop-nav",children:(0,h.jsx)(n.Z,{navbarColour:"#FDF7F0"})}),(0,h.jsx)("div",{className:"mobile-nav",children:(0,h.jsx)(o.Z,{setProfileContent:f,profileContent:v,profileDetail:N,setProfileDetail:y})}),(0,h.jsx)(r.Z,{setProfileDetail:y,variableSide:b,setProfileContent:f,setVariableSide:k,userData:u}),(0,h.jsx)("section",{className:"main-body",children:(0,h.jsx)("section",{className:"main-body-details",children:(0,h.jsx)(h.Fragment,{children:u&&u.usage_stats[0]&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<101)?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsxs)("div",{className:"listing-options",children:[(0,h.jsx)("div",{className:"listing-buttons"}),(0,h.jsx)("div",{className:"logout-button",onClick:s=>{localStorage.removeItem("wittle-user-token"),localStorage.removeItem("wittle-username"),e("/login")},children:(0,h.jsx)("div",{className:"logout-icon"})})]}),(0,h.jsx)("hr",{className:"title-line"}),(0,h.jsxs)("div",{className:"epc-matcher",children:[(0,h.jsxs)("div",{className:"input-section",children:[(0,h.jsx)("h3",{className:"sub-title",children:"Input property details to find  details about live listings"}),m?(0,h.jsx)(d.Z,{}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Property category"}),(0,h.jsx)("input",{type:"text",value:T,onChange:e=>W(e.target.value),placeholder:"Enter category"})]})}),(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Postcode"}),(0,h.jsx)("input",{type:"text",value:_,onChange:e=>C(e.target.value),placeholder:"Enter postcode..."})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Road name"}),(0,h.jsx)("input",{type:"text",value:S,onChange:e=>E(e.target.value)})]})]}),(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Efficiency (numbers) or Rating (letters)"}),(0,h.jsxs)("select",{onChange:e=>I(e.target.value),children:[(0,h.jsx)("option",{children:"Efficiency"}),(0,h.jsx)("option",{children:"Rating"})]})]})}),"Efficiency"===H?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:w,onChange:e=>P(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:F,onChange:e=>Z(e.target.value)})]})]})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Rating"}),(0,h.jsx)("input",{type:"text",value:w,onChange:e=>P(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Rating"}),(0,h.jsx)("input",{type:"text",value:F,onChange:e=>Z(e.target.value)})]})]})}),(0,h.jsx)("div",{className:"search-section",children:(0,h.jsx)("button",{className:"load-insights",onClick:async()=>{x(!0),j(!1);const e=_.replace(/\s+/g,"");try{const{data:s}=await l.Z.get(`/api/epc/${e}`);if(console.log("Postcode data ->",s),B(s),s&&Array.isArray(s)&&s.length>0){let e=s;"Efficiency"===H?e=e.filter((e=>(!S||e.address.toLowerCase().includes(S.toLowerCase()))&&(!w||e.current_energy_efficiency===Number(w))&&(!F||e.potential_energy_efficiency===Number(F)))):"Rating"===H&&(e=e.filter((e=>(!S||e.address.toLowerCase().includes(S.toLowerCase()))&&(!w||e.current_energy_rating===w.toUpperCase())&&(!F||e.potential_energy_rating===F.toUpperCase())))),e=e.sort(((e,s)=>new Date(s.inspection_date)-new Date(e.inspection_date))),e.length>0?(R(e),console.log("filtered data->",e),Y()):0===e.length&&R(""),x(!1)}else console.log("No postcode data available"),x(!1)}catch(s){R(""),t(!0),console.log(s),x(!1)}j(!0)},children:"Load Properties"})})]})]}),(0,h.jsx)("div",{className:"property-results",children:(0,h.jsx)("div",{className:"results-block",children:0!==A.length||p?p&&0===D.length?(0,h.jsx)("h3",{className:"sub-title",children:"We couldn't find anything that matched your search"}):p&&D.length>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("h3",{className:"sub-title",children:["You have ",D.length," matching results"]}),(0,h.jsx)("div",{className:"results-details",children:D?D.map(((s,t)=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"results-content",children:[(0,h.jsx)("h5",{className:"row-value",children:t+1}),(0,h.jsxs)("div",{className:"results-items",children:[(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"catchment"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Address: "}),(0,h.jsx)("h5",{className:"text-result",children:s.address})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"house"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor area: "}),(0,h.jsxs)("h5",{className:"text-result",children:[s.floor_area," sq.m"]})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"location"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Postcode: "}),(0,h.jsx)("h5",{className:"text-result",children:s.postcode})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"building"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor level: "}),(0,h.jsx)("h5",{className:"text-result",children:s.final_floor_level})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"search"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"last inspection: "}),(0,h.jsx)("h5",{className:"text-result",children:s.inspection_date})]})]})]}),(0,h.jsx)("div",{className:"column",id:"column5",children:q(s)?(0,h.jsx)("button",{className:"added",onClick:()=>(async s=>{if((0,c.Hb)())try{const{data:e}=await l.Z.delete("/api/epc_favourite/",{data:{postcode:s.postcode,address:s.address},headers:{Authorization:`Bearer ${(0,c.hP)()}`}});e.message&&U((e=>e.filter((e=>e.postcode!==s.postcode||e.address!==s.address))))}catch(t){console.error("Error deleting favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"\u2714\ufe0f"}):(0,h.jsx)("button",{className:"add",onClick:()=>(async s=>{if((0,c.Hb)())try{const{data:e}=await l.Z.post("/api/epc_favourite/",{postcode:s.postcode,address:s.address,category:T},{headers:{Authorization:`Bearer ${(0,c.hP)()}`}});console.log("session name->",T),e.message&&!q(s)&&U((e=>[...e,{postcode:s.postcode,address:s.address,category:T}]))}catch(t){console.error("Error saving favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"+"})})]},t),(0,h.jsx)("hr",{className:"property-divider"})]}))):""})]}):"":(0,h.jsx)("h3",{className:"sub-title",children:"Start new search to see results"})})})]})]}):u&&"Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=11?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have reached the free limit of matches for this month, get in touch to unlock another 90 matches."})]}):u&&"Advanced pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=101?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have carried out 100 matches this month, get in touch to discuss increasing your limit."})]}):""})})})]})})}},7837:function(e,s,t){e.exports=t.p+"static/media/new-loading.a788dadda3b120785a81.gif"}}]);
//# sourceMappingURL=453.2a3a97d4.chunk.js.b1c57ae892af.map