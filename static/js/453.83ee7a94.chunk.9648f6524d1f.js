"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[453,177],{74177:function(e,s,t){t(72791);var a=t(80184);s.Z=()=>(0,a.jsx)("div",{className:"loading-gif",children:(0,a.jsx)("img",{src:t(57837),alt:"loading gif"})})},24604:function(e,s,t){t(72791);var a=t(80184);s.Z=e=>{let{setProfileContent:s,profileContent:t,profileDetail:l,setProfileDetail:i}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"mobile-selector-section",children:(0,a.jsx)("div",{className:"mobile-title-slider",children:"Search"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Wittle search"),style:{fontWeight:"Wittle search"===l?"700":"500",backgroundColor:"Wittle search"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Wittle search"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Property search"),style:{fontWeight:"Property search"===l?"700":"500",backgroundColor:"Property search"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Property search"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Saved properties"),style:{fontWeight:"Saved properties"===l?"700":"500",backgroundColor:"Saved properties"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Saved properties"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Saved searches"),style:{fontWeight:"Saved searches"===l?"700":"500",backgroundColor:"Saved searches"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Saved searches"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Property comparison"),style:{fontWeight:"Property comparison"===l?"700":"500",backgroundColor:"Property comparison"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Property comparison"})]}):"Lifestyle"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Lifestyle search"),style:{fontWeight:"Lifestyle search"===l?"700":"500",backgroundColor:"Lifestyle search"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Search"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("List"),style:{fontWeight:"List"===l?"700":"500",backgroundColor:"List"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Saved places"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Lifestyle insights"),style:{fontWeight:"Lifestyle insights"===l?"700":"500",backgroundColor:"Lifestyle insights"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Insights"})]}):"Admin"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Admin dashboard"),style:{fontWeight:"Admin dashboard"===l?"700":"500",backgroundColor:"Admin dashboard"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Dashboard"}),(0,a.jsx)("h2",{className:"pills",onClick:()=>i("Admin opportunities"),style:{fontWeight:"Admin opportunities"===l?"700":"500",backgroundColor:"Admin opportunities"===l?"#FFA7E5":"rgba(255, 167, 229, 0.1)"},children:"Opportunity"})]}):""})})})}},94453:function(e,s,t){t.r(s);var a=t(72791),l=t(31243),i=t(57689),r=t(97165),c=(t(99696),t(24604),t(60764)),n=t(52094),o=t(78084),d=t(74177),h=t(80184);l.Z.defaults.xsrfCookieName="csrftoken",l.Z.defaults.xsrfHeaderName="X-CSRFToken";s.default=()=>{const e=(0,i.s0)(),[s,t]=(0,a.useState)(),[u,g]=(0,a.useState)(),[m,p]=(0,a.useState)(),[x,j]=(0,a.useState)(!1),[f,v]=(0,a.useState)("Comparison"),[N,y]=(0,a.useState)("Comparison"),[b,k]=(0,a.useState)(!1),[C,F]=(0,a.useState)(""),[S,_]=(0,a.useState)(""),[E,A]=(0,a.useState)(),[P,w]=(0,a.useState)(),[W,L]=(0,a.useState)([]),[Z,D]=(0,a.useState)([]),[B,R]=(0,a.useState)(""),[$,I]=(0,a.useState)("Efficiency"),[z,H]=(0,a.useState)([]),[U,T]=(0,a.useState)(sessionStorage.getItem("sessionName")||"");(0,a.useEffect)((()=>{(0,r.Hb)()?(async()=>{try{const{data:e}=await l.Z.get(`/api/auth/profile/${(0,r.Nh)()}/`,{headers:{Authorization:`Bearer ${(0,r.hP)()}`}});console.log("user data ->",e),g(e)}catch(e){t(!0),console.log(e)}})():(e("/access-denied"),console.log("no account"))}),[]);const Y=async()=>{if((0,r.Hb)()){console.log("trying to increase");try{const{data:e}=await l.Z.post("/api/usage/",{},{headers:{Authorization:`Bearer ${(0,r.hP)()}`}});console.log(e),"success"===e.status?console.log("Usage count increased successfully"):console.error("Failed to increase usage count:",e.message)}catch(s){console.error("Error:",s)}}else e("/access-denied"),console.log("logged out")};function q(e){return z.some((s=>s.postcode===e.postcode&&s.address===e.address))}(0,a.useEffect)((()=>{(async()=>{try{const{data:e}=await l.Z.get("/api/epc_favourite/",{headers:{Authorization:`Bearer ${(0,r.hP)()}`}});H(e)}catch(e){console.error("Error fetching favourites:",e)}})()}),[]),(0,a.useEffect)((()=>{U&&sessionStorage.setItem("sessionName",U)}),[U]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("section",{className:"agent-profile-page",children:[(0,h.jsx)("div",{className:"desktop-nav",children:(0,h.jsx)(c.Z,{navbarColour:"#FDF7F0"})}),(0,h.jsx)("div",{className:"mobile-nav",children:(0,h.jsx)(o.Z,{setProfileContent:v,profileContent:f,profileDetail:N,setProfileDetail:y})}),(0,h.jsx)(n.Z,{setProfileDetail:y,variableSide:b,setProfileContent:v,setVariableSide:k,userData:u}),(0,h.jsx)("section",{className:"main-body",children:(0,h.jsx)("section",{className:"main-body-details",children:(0,h.jsx)(h.Fragment,{children:u&&u.usage_stats[0]&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<101)?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsxs)("div",{className:"listing-options",children:[(0,h.jsx)("div",{className:"listing-buttons"}),(0,h.jsx)("div",{className:"logout-button",onClick:s=>{localStorage.removeItem("wittle-user-token"),localStorage.removeItem("wittle-username"),e("/login")},children:(0,h.jsx)("div",{className:"logout-icon"})})]}),(0,h.jsx)("hr",{className:"title-line"}),(0,h.jsxs)("div",{className:"epc-matcher",children:[(0,h.jsxs)("div",{className:"input-section",children:[(0,h.jsx)("h3",{className:"sub-title",children:"Input property details to find  details about live listings"}),m?(0,h.jsx)(d.Z,{}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Property category"}),(0,h.jsx)("input",{type:"text",value:U,onChange:e=>T(e.target.value),placeholder:"Enter category"})]})}),(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Postcode"}),(0,h.jsx)("input",{type:"text",value:C,onChange:e=>F(e.target.value),placeholder:"Enter postcode..."})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Road name"}),(0,h.jsx)("input",{type:"text",value:S,onChange:e=>_(e.target.value)})]})]}),(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Efficiency (numbers) or Rating (letters)"}),(0,h.jsxs)("select",{onChange:e=>I(e.target.value),children:[(0,h.jsx)("option",{children:"Efficiency"}),(0,h.jsx)("option",{children:"Rating"})]})]})}),"Efficiency"===$?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:E,onChange:e=>A(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:P,onChange:e=>w(e.target.value)})]})]})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Rating"}),(0,h.jsx)("input",{type:"text",value:E,onChange:e=>A(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Rating"}),(0,h.jsx)("input",{type:"text",value:P,onChange:e=>w(e.target.value)})]})]})}),(0,h.jsx)("div",{className:"search-section",children:(0,h.jsx)("button",{className:"load-insights",onClick:async()=>{p(!0),j(!1);const e=C.replace(/\s+/g,"");try{const{data:s}=await l.Z.get(`/api/epc/${e}`);if(console.log("Postcode data ->",s),L(s),s&&Array.isArray(s)&&s.length>0){let e=s;"Efficiency"===$?e=e.filter((e=>(!S||e.address.toLowerCase().includes(S.toLowerCase()))&&(!E||e.current_energy_efficiency===Number(E))&&(!P||e.potential_energy_efficiency===Number(P)))):"Rating"===$&&(e=e.filter((e=>(!S||e.address.toLowerCase().includes(S.toLowerCase()))&&(!E||e.current_energy_rating===E.toUpperCase())&&(!P||e.potential_energy_rating===P.toUpperCase())))),e=e.sort(((e,s)=>new Date(s.inspection_date)-new Date(e.inspection_date))),e.length>0?(D(e),console.log("filtered data->",e),Y()):0===e.length&&D(""),p(!1)}else console.log("No postcode data available"),p(!1)}catch(s){D(""),t(!0),console.log(s),p(!1)}j(!0)},children:"Load Properties"})})]})]}),(0,h.jsx)("div",{className:"property-results",children:(0,h.jsx)("div",{className:"results-block",children:0!==W.length||x?x&&0===Z.length?(0,h.jsx)("h3",{className:"sub-title",children:"We couldn't find anything that matched your search"}):x&&Z.length>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("h3",{className:"sub-title",children:["You have ",Z.length," matching results"]}),(0,h.jsx)("div",{className:"results-details",children:Z?Z.map(((s,t)=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"results-content",children:[(0,h.jsx)("h5",{className:"row-value",children:t+1}),(0,h.jsxs)("div",{className:"results-items",children:[(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"catchment"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Address: "}),(0,h.jsx)("h5",{className:"text-result",children:s.address})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"house"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor area: "}),(0,h.jsxs)("h5",{className:"text-result",children:[s.floor_area," sq.m"]})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"location"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Postcode: "}),(0,h.jsx)("h5",{className:"text-result",children:s.postcode})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"building"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor level: "}),(0,h.jsx)("h5",{className:"text-result",children:s.final_floor_level})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"search"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"last inspection: "}),(0,h.jsx)("h5",{className:"text-result",children:s.inspection_date})]})]})]}),(0,h.jsx)("div",{className:"column",id:"column5",children:q(s)?(0,h.jsx)("button",{className:"added",onClick:()=>(async s=>{if((0,r.Hb)())try{const{data:e}=await l.Z.delete("/api/epc_favourite/",{data:{postcode:s.postcode,address:s.address},headers:{Authorization:`Bearer ${(0,r.hP)()}`}});e.message&&H((e=>e.filter((e=>e.postcode!==s.postcode||e.address!==s.address))))}catch(t){console.error("Error deleting favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"\u2714\ufe0f"}):(0,h.jsx)("button",{className:"add",onClick:()=>(async s=>{if((0,r.Hb)())try{const{data:e}=await l.Z.post("/api/epc_favourite/",{postcode:s.postcode,address:s.address,category:U},{headers:{Authorization:`Bearer ${(0,r.hP)()}`}});console.log("session name->",U),e.message&&!q(s)&&H((e=>[...e,{postcode:s.postcode,address:s.address,category:U}]))}catch(t){console.error("Error saving favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"+"})})]},t),(0,h.jsx)("hr",{className:"property-divider"})]}))):""})]}):"":(0,h.jsx)("h3",{className:"sub-title",children:"Start new search to see results"})})})]})]}):u&&"Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=11?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have reached the free limit of matches for this month, get in touch to unlock another 90 matches."})]}):u&&"Advanced pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=101?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have carried out 100 matches this month, get in touch to discuss increasing your limit."})]}):""})})})]})})}},57837:function(e,s,t){e.exports=t.p+"static/media/new-loading.a788dadda3b120785a81.gif"}}]);
//# sourceMappingURL=453.83ee7a94.chunk.js.48fc375cc0f6.map