"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[532,550,631],{74177:function(e,s,t){t(72791);var n=t(80184);s.Z=()=>(0,n.jsx)("div",{className:"loading-gif",children:(0,n.jsx)("img",{src:t(29193),alt:"loading gif"})})},24604:function(e,s,t){t(72791),t(80184)},94453:function(e,s,t){t.r(s);var n=t(72791),a=t(55294),r=t(57689),i=t(97165),c=(t(99696),t(24604),t(60764)),l=t(52094),o=t(78084),d=t(74177),h=t(80184);a.Z.defaults.xsrfCookieName="csrftoken",a.Z.defaults.xsrfHeaderName="X-CSRFToken";s.default=()=>{const e=(0,r.s0)(),[s,t]=(0,n.useState)(),[u,p]=(0,n.useState)(),[f,x]=(0,n.useState)(),[m,g]=(0,n.useState)(!1),[v,j]=(0,n.useState)("Comparison"),[y,N]=(0,n.useState)("Comparison"),[_,b]=(0,n.useState)(!1),[k,C]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[E,P]=(0,n.useState)(),[A,F]=(0,n.useState)(),[Z,L]=(0,n.useState)([]),[O,B]=(0,n.useState)([]),[D,R]=(0,n.useState)(""),[$,z]=(0,n.useState)("Efficiency"),[H,I]=(0,n.useState)([]),[T,U]=(0,n.useState)(sessionStorage.getItem("sessionName")||"");(0,n.useEffect)((()=>{(0,i.Hb)()?(async()=>{try{const{data:e}=await a.Z.get(`/api/auth/profile/${(0,i.Nh)()}/`,{headers:{Authorization:`Bearer ${(0,i.hP)()}`}});console.log("user data ->",e),p(e)}catch(e){t(!0),console.log(e)}})():(e("/access-denied"),console.log("no account"))}),[]);const W=async()=>{if((0,i.Hb)()){console.log("trying to increase");try{const{data:e}=await a.Z.post("/api/usage/",{},{headers:{Authorization:`Bearer ${(0,i.hP)()}`}});console.log(e),"success"===e.status?console.log("Usage count increased successfully"):console.error("Failed to increase usage count:",e.message)}catch(s){console.error("Error:",s)}}else e("/access-denied"),console.log("logged out")};function Y(e){return H.some((s=>s.postcode===e.postcode&&s.address===e.address))}(0,n.useEffect)((()=>{(async()=>{try{const{data:e}=await a.Z.get("/api/epc_favourite/",{headers:{Authorization:`Bearer ${(0,i.hP)()}`}});I(e)}catch(e){console.error("Error fetching favourites:",e)}})()}),[]),(0,n.useEffect)((()=>{T&&sessionStorage.setItem("sessionName",T)}),[T]);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("section",{className:"agent-profile-page",children:[(0,h.jsx)("div",{className:"desktop-nav",children:(0,h.jsx)(c.Z,{navbarColour:"#FDF7F0"})}),(0,h.jsx)("div",{className:"mobile-nav",children:(0,h.jsx)(o.Z,{setProfileContent:j,profileContent:v,profileDetail:y,setProfileDetail:N})}),(0,h.jsx)(l.Z,{setProfileDetail:N,variableSide:_,setProfileContent:j,setVariableSide:b,userData:u}),(0,h.jsx)("section",{className:"main-body",children:(0,h.jsx)("section",{className:"main-body-details",children:(0,h.jsx)(h.Fragment,{children:u&&u.usage_stats[0]&&("Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<11||"Unlimited"===u.usage_stats[0].package||"Advanced Pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count<101)?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsxs)("div",{className:"listing-options",children:[(0,h.jsx)("div",{className:"listing-buttons"}),(0,h.jsx)("div",{className:"logout-button",onClick:s=>{localStorage.removeItem("wittle-user-token"),localStorage.removeItem("wittle-username"),e("/login")},children:(0,h.jsx)("div",{className:"logout-icon"})})]}),(0,h.jsx)("hr",{className:"title-line"}),(0,h.jsxs)("div",{className:"epc-matcher",children:[(0,h.jsxs)("div",{className:"input-section",children:[(0,h.jsx)("h3",{className:"sub-title",children:"Input property details to find  details about live listings"}),f?(0,h.jsx)(d.Z,{}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Property category"}),(0,h.jsx)("input",{type:"text",value:T,onChange:e=>U(e.target.value),placeholder:"Enter category"})]})}),(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Postcode"}),(0,h.jsx)("input",{type:"text",value:k,onChange:e=>C(e.target.value),placeholder:"Enter postcode..."})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Road name"}),(0,h.jsx)("input",{type:"text",value:w,onChange:e=>S(e.target.value)})]})]}),(0,h.jsx)("div",{className:"single-input-block",children:(0,h.jsxs)("div",{className:"input-block large",children:[(0,h.jsx)("h3",{children:"Efficiency (numbers) or Rating (letters)"}),(0,h.jsxs)("select",{onChange:e=>z(e.target.value),children:[(0,h.jsx)("option",{children:"Efficiency"}),(0,h.jsx)("option",{children:"Rating"})]})]})}),"Efficiency"===$?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:E,onChange:e=>P(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Efficiency"}),(0,h.jsx)("input",{type:"number",value:A,onChange:e=>F(e.target.value)})]})]})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"double-input-block",children:[(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Current Energy Rating"}),(0,h.jsx)("input",{type:"text",value:E,onChange:e=>P(e.target.value)})]}),(0,h.jsxs)("div",{className:"input-block half",children:[(0,h.jsx)("h3",{children:"Potential Energy Rating"}),(0,h.jsx)("input",{type:"text",value:A,onChange:e=>F(e.target.value)})]})]})}),(0,h.jsx)("div",{className:"search-section",children:(0,h.jsx)("button",{className:"load-insights",onClick:async()=>{x(!0),g(!1);const e=k.replace(/\s+/g,"");try{const{data:s}=await a.Z.get(`/api/epc/${e}`);if(console.log("Postcode data ->",s),L(s),s&&Array.isArray(s)&&s.length>0){let e=s;"Efficiency"===$?e=e.filter((e=>(!w||e.address.toLowerCase().includes(w.toLowerCase()))&&(!E||e.current_energy_efficiency===Number(E))&&(!A||e.potential_energy_efficiency===Number(A)))):"Rating"===$&&(e=e.filter((e=>(!w||e.address.toLowerCase().includes(w.toLowerCase()))&&(!E||e.current_energy_rating===E.toUpperCase())&&(!A||e.potential_energy_rating===A.toUpperCase())))),e=e.sort(((e,s)=>new Date(s.inspection_date)-new Date(e.inspection_date))),e.length>0?(B(e),console.log("filtered data->",e),W()):0===e.length&&B(""),x(!1)}else console.log("No postcode data available"),x(!1)}catch(s){B(""),t(!0),console.log(s),x(!1)}g(!0)},children:"Load Properties"})})]})]}),(0,h.jsx)("div",{className:"property-results",children:(0,h.jsx)("div",{className:"results-block",children:0!==Z.length||m?m&&0===O.length?(0,h.jsx)("h3",{className:"sub-title",children:"We couldn't find anything that matched your search"}):m&&O.length>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("h3",{className:"sub-title",children:["You have ",O.length," matching results"]}),(0,h.jsx)("div",{className:"results-details",children:O?O.map(((s,t)=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"results-content",children:[(0,h.jsx)("h5",{className:"row-value",children:t+1}),(0,h.jsxs)("div",{className:"results-items",children:[(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"catchment"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Address: "}),(0,h.jsx)("h5",{className:"text-result",children:s.address})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"house"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor area: "}),(0,h.jsxs)("h5",{className:"text-result",children:[s.floor_area," sq.m"]})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"location"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Postcode: "}),(0,h.jsx)("h5",{className:"text-result",children:s.postcode})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"building"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"Floor level: "}),(0,h.jsx)("h5",{className:"text-result",children:s.final_floor_level})]})]}),(0,h.jsxs)("div",{className:"results-line",children:[(0,h.jsx)("div",{className:"result-icon",id:"search"}),(0,h.jsxs)("div",{className:"results-text",children:[(0,h.jsx)("h5",{className:"text-title",children:"last inspection: "}),(0,h.jsx)("h5",{className:"text-result",children:s.inspection_date})]})]})]}),(0,h.jsx)("div",{className:"column",id:"column5",children:Y(s)?(0,h.jsx)("button",{className:"added",onClick:()=>(async s=>{if((0,i.Hb)())try{const{data:e}=await a.Z.delete("/api/epc_favourite/",{data:{postcode:s.postcode,address:s.address},headers:{Authorization:`Bearer ${(0,i.hP)()}`}});e.message&&I((e=>e.filter((e=>e.postcode!==s.postcode||e.address!==s.address))))}catch(t){console.error("Error deleting favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"\u2714\ufe0f"}):(0,h.jsx)("button",{className:"add",onClick:()=>(async s=>{if((0,i.Hb)())try{const{data:e}=await a.Z.post("/api/epc_favourite/",{postcode:s.postcode,address:s.address,category:T},{headers:{Authorization:`Bearer ${(0,i.hP)()}`}});console.log("session name->",T),e.message&&!Y(s)&&I((e=>[...e,{postcode:s.postcode,address:s.address,category:T}]))}catch(t){console.error("Error saving favourite:",t)}else e("/access-denied"),console.log("logged out")})(s),children:"+"})})]},t),(0,h.jsx)("hr",{className:"property-divider"})]}))):""})]}):"":(0,h.jsx)("h3",{className:"sub-title",children:"Start new search to see results"})})})]})]}):u&&"Basic"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=11?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have reached the free limit of matches for this month, get in touch to unlock another 90 matches."})]}):u&&"Advanced pilot"===u.usage_stats[0].package&&u.usage_stats[0].epc_monthly_count>=101?(0,h.jsxs)("section",{className:"property-finder",children:[(0,h.jsx)("h1",{children:"\ud83d\ude4f Thanks for enjoying Wittle!"}),(0,h.jsx)("h3",{className:"limit-reached",children:"You have carried out 100 matches this month, get in touch to discuss increasing your limit."})]}):""})})})]})})}},97143:function(e){var s=Object.prototype.hasOwnProperty,t="~";function n(){}function a(e,s,t){this.fn=e,this.context=s,this.once=t||!1}function r(e,s,n,r,i){if("function"!==typeof n)throw new TypeError("The listener must be a function");var c=new a(n,r||e,i),l=t?t+s:s;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],c]:e._events[l].push(c):(e._events[l]=c,e._eventsCount++),e}function i(e,s){0===--e._eventsCount?e._events=new n:delete e._events[s]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(t=!1)),c.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)s.call(e,n)&&a.push(t?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},c.prototype.listeners=function(e){var s=t?t+e:e,n=this._events[s];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,r=n.length,i=new Array(r);a<r;a++)i[a]=n[a].fn;return i},c.prototype.listenerCount=function(e){var s=t?t+e:e,n=this._events[s];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,s,n,a,r,i){var c=t?t+e:e;if(!this._events[c])return!1;var l,o,d=this._events[c],h=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),h){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,s),!0;case 3:return d.fn.call(d.context,s,n),!0;case 4:return d.fn.call(d.context,s,n,a),!0;case 5:return d.fn.call(d.context,s,n,a,r),!0;case 6:return d.fn.call(d.context,s,n,a,r,i),!0}for(o=1,l=new Array(h-1);o<h;o++)l[o-1]=arguments[o];d.fn.apply(d.context,l)}else{var u,p=d.length;for(o=0;o<p;o++)switch(d[o].once&&this.removeListener(e,d[o].fn,void 0,!0),h){case 1:d[o].fn.call(d[o].context);break;case 2:d[o].fn.call(d[o].context,s);break;case 3:d[o].fn.call(d[o].context,s,n);break;case 4:d[o].fn.call(d[o].context,s,n,a);break;default:if(!l)for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];d[o].fn.apply(d[o].context,l)}}return!0},c.prototype.on=function(e,s,t){return r(this,e,s,t,!1)},c.prototype.once=function(e,s,t){return r(this,e,s,t,!0)},c.prototype.removeListener=function(e,s,n,a){var r=t?t+e:e;if(!this._events[r])return this;if(!s)return i(this,r),this;var c=this._events[r];if(c.fn)c.fn!==s||a&&!c.once||n&&c.context!==n||i(this,r);else{for(var l=0,o=[],d=c.length;l<d;l++)(c[l].fn!==s||a&&!c[l].once||n&&c[l].context!==n)&&o.push(c[l]);o.length?this._events[r]=1===o.length?o[0]:o:i(this,r)}return this},c.prototype.removeAllListeners=function(e){var s;return e?(s=t?t+e:e,this._events[s]&&i(this,s)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,e.exports=c},29193:function(e,s,t){e.exports=t.p+"static/media/transparent-spinner.f3eb62caffaa8568ecbe.gif"},13631:function(e,s,t){var n=t(97143);s.Z=n}}]);
//# sourceMappingURL=532.820b996a.chunk.js.cd69ff3b66e4.map