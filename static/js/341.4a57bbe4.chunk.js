"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[341],{341:function(e,s,t){t.r(s),t.d(s,{default:function(){return k}});var a=t(2791),i=t(5294),r=t(7689),l=t(7165),n=t(8084),o=t(764),c=t(2094),d=t(3685),h=t(948),p=t(184);var m=e=>{let{agentFavourites:s,loadUserData:t,deleteAgentFavourite:i,currentClient:r}=e;const[l,n]=(0,a.useState)("Sales");return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("section",{className:"agent-saved-properties",children:[(0,p.jsxs)("div",{className:"saved-property-channel",children:[(0,p.jsx)("h5",{className:"channel-pills "+("Sales"===l?"active":"inactive"),onClick:()=>n("Sales"),children:"Sales"}),(0,p.jsx)("h5",{className:"channel-pills "+("Lettings"===l?"active":"inactive"),onClick:()=>n("Lettings"),children:"Lettings"})]}),s?(0,p.jsxs)("div",{className:"saved-properties-body",children:[r?(0,p.jsxs)("h3",{className:"saved-number",children:[r.first_name," ",r.last_name," has ",s.filter((e=>e.channel===l)).length," saved ",l.toLocaleLowerCase()," properties "]}):(0,p.jsxs)("h3",{className:"saved-number",children:["You have ",s.filter((e=>e.channel===l)).length," saved ",l.toLocaleLowerCase()," properties "]}),(0,p.jsx)("div",{className:"saved-properties-grid",children:(0,p.jsx)("div",{className:"saved-properties-array",children:s?s.filter((e=>e.channel===l)).map(((e,s)=>(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"saved-property",children:[(0,p.jsx)("div",{className:"saved-image",style:{backgroundImage:`url(${e.images})`},onClick:()=>(e=>{const s=document.createElement("a");s.href=e,s.target="_blank",s.rel="noreferrer",s.windowFeatures="width=1200,height=800,resizable=yes,scrollbars=yes,status=yes",document.body.appendChild(s),s.click(),document.body.removeChild(s)})(e.url)}),(0,p.jsxs)("div",{className:"saved-body",children:[(0,p.jsx)("h3",{className:"saved-title",children:e.displayAddress}),(0,p.jsxs)("div",{className:"saved-block",children:[(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"money"}),"Sales"===e.channel?(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.price_numeric,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," "]}):(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.price_numeric,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," pcm"]})]}),(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"flame"}),(0,p.jsxs)("h3",{children:[(10*e.score).toFixed(0),"% match"]})]})]}),(0,p.jsxs)("div",{className:"saved-block",children:[(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"bed"}),(0,p.jsxs)("h3",{children:[e.bedrooms," bedrooms"]})]}),(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"bath"}),(0,p.jsxs)("h3",{children:[e.bathrooms," bathrooms"]})]})]}),(0,p.jsxs)("div",{className:"final-block",children:[(0,p.jsx)("h3",{children:e.agent}),(0,p.jsx)("button",{onClick:()=>i(e),children:"Delete"})]})]})]})}))):""})})]}):""]})})},u=t(4177),v=t(936);t(7842);var x=e=>{let{clientInputShow:s,handleClientInputClose:t,clientInputDetails:a,setClientInputDetails:i,addNewClient:r}=e;return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(v.Z,{show:s,onHide:t,backdrop:"static",className:"add-client-modal",children:(0,p.jsxs)("section",{className:"overall-body",children:[(0,p.jsx)("section",{className:"input-header",children:(0,p.jsxs)("div",{className:"input-title",children:[(0,p.jsx)("h1",{children:"Add client details"}),(0,p.jsx)("h1",{className:"close-modal",onClick:t,children:"X"})]})}),(0,p.jsxs)("section",{className:"input-main",children:[(0,p.jsxs)("div",{className:"input-row",children:[(0,p.jsx)("h3",{className:"input-title",children:"First name"}),(0,p.jsx)("input",{placeholder:"",className:"dropdown",value:a.first_name||"",onChange:e=>i((s=>({...s,first_name:e.target.value})))})]}),(0,p.jsxs)("div",{className:"input-row",children:[(0,p.jsx)("h3",{className:"input-title",children:"Last name"}),(0,p.jsx)("input",{placeholder:"",className:"dropdown",value:a.last_name||"",onChange:e=>i((s=>({...s,last_name:e.target.value})))})]}),(0,p.jsxs)("div",{className:"input-row",children:[(0,p.jsx)("h3",{className:"input-title",children:"Email"}),(0,p.jsx)("input",{placeholder:"",className:"dropdown",value:a.email||"",onChange:e=>i((s=>({...s,email:e.target.value})))})]}),(0,p.jsxs)("div",{className:"input-row",children:[(0,p.jsx)("h3",{className:"input-title",children:"Current area"}),(0,p.jsx)("input",{placeholder:"",className:"dropdown",value:a.area||"",onChange:e=>i((s=>({...s,area:e.target.value})))})]}),(0,p.jsxs)("div",{className:"input-row",children:[(0,p.jsx)("h3",{className:"input-title",children:"Area looking"}),(0,p.jsx)("input",{placeholder:"",className:"dropdown",value:a.looking||"",onChange:e=>i((s=>({...s,looking:e.target.value})))})]})]}),(0,p.jsx)("section",{className:"input-footer",children:(0,p.jsx)("button",{className:"load-properties",onClick:r,children:"Add client"})})]})})})},g=t(1069),y=t(6048),j=t.n(y),_=t(4648);t(6129);var N=e=>{let{setListingSelection:s,fetchData:t,agentFavourites:i,loadUserData:l,addAgentFavourite:n,deleteAgentFavourite:o,propertyFilters:c,setPropertyFilters:d,currentClient:m,handlePropertyInputClose:v,handlePropertyInputShow:x,propertyInputShow:y,toggleStatus:N,loadProperties:b,properties:f,setProperties:S,loading:w,loadPrimaryData:k,primarySearchDetails:C,setPrimarySearchDetails:P,selectedPrimary:D,setSelectedPrimary:F}=e;const I=(0,r.s0)(),[A,L]=(0,a.useState)("Table"),[E,T]=(0,a.useState)(null),[O,M]=(0,a.useState)(!0),[$,z]=(0,a.useState)(),[B,H]=(0,a.useState)("Details");(0,a.useRef)(new Map);(0,a.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("client-property-filters")),s=JSON.parse(localStorage.getItem("client-properties")),t=JSON.parse(localStorage.getItem("client-email"))===m.email;e&&t&&(d(e),S(s))}),[]);const W=e=>{const s=document.createElement("a");s.href=e,s.target="_blank",s.rel="noreferrer",s.windowFeatures="width=1200,height=800,resizable=yes,scrollbars=yes,status=yes",document.body.appendChild(s),s.click(),document.body.removeChild(s)},R=e=>{console.log("postcode ->",e.property_data.postcode),window.localStorage.setItem("listing-postcode",JSON.stringify(e.property_data.postcode)),window.localStorage.setItem("listing-route",JSON.stringify("On")),t(),s("Property insights"),I("/agents/listing-generator")},[U,Z]=(0,a.useState)(0),J=50*U,V=J+50,[G,X]=(0,a.useState)({latitude:51.515419,longitude:-.141099,zoom:10.5}),Y=e=>{M(!0),console.log(O),z(parseInt(e.target.id)),console.log(parseInt(e.target.id))},q=e=>{const{selected:s}=e;Z(s)},Q=e=>e>.9?"Outstanding":e>.8?"Excellent":e>.7?"Very good":e>.6?"Good":e>.5?"Quite good":e>.4?"Average":e>.3?"Below average":e>.2?"Bad":e>.1?"Poor":"Terrible";return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("section",{className:"top-properties",children:[(0,p.jsx)("section",{className:"top-properties-filters",children:(0,p.jsx)("div",{className:"filter-block mobile",children:(0,p.jsx)("button",{onClick:x,children:"Edit search"})})}),w?w?(0,p.jsx)("div",{className:"property-table-loading",children:(0,p.jsx)(u.Z,{})}):"":(0,p.jsxs)("section",{className:"top-property-results",children:[(0,p.jsxs)("div",{className:"top-property-title",children:[(0,p.jsx)("h3",{children:f?`${f.length} matching properties`:""}),(0,p.jsxs)("div",{className:"view-selectors",children:[(0,p.jsx)("button",{className:"edit-search",onClick:x,children:"Edit search"}),(0,p.jsx)("div",{className:"icon-box "+("Table"===A?"active":"inactive"),onClick:()=>L("Table"),children:(0,p.jsx)("div",{className:"icon",id:"table"})}),(0,p.jsx)("div",{className:"icon-box "+("Map"===A?"active":"inactive"),onClick:()=>L("Map"),children:(0,p.jsx)("div",{className:"icon",id:"map"})}),(0,p.jsx)("div",{className:"icon-box "+("Grid"===A?"active":"inactive"),onClick:()=>L("Grid"),children:(0,p.jsx)("div",{className:"icon",id:"grid"})})]})]}),"Table"===A&&f?(0,p.jsxs)("div",{className:"property-table-view",children:[(0,p.jsxs)("div",{className:"top-property-table",children:[(0,p.jsxs)("div",{className:"table-headers",children:[(0,p.jsx)("div",{id:"column1",className:"column",children:(0,p.jsx)("h5",{children:"#"})}),(0,p.jsx)("div",{id:"column2",className:"column",children:(0,p.jsx)("h5",{children:"Address"})}),(0,p.jsx)("div",{id:"column3",className:"column",children:(0,p.jsx)("h5",{children:"Postcode"})}),(0,p.jsx)("div",{id:"column4",className:"column",children:(0,p.jsx)("h5",{children:"Area"})}),(0,p.jsx)("div",{id:"column5",className:"column",children:(0,p.jsx)("h5",{children:"Added"})}),(0,p.jsx)("div",{id:"column6",className:"column",children:(0,p.jsx)("h5",{children:"Price"})}),(0,p.jsx)("div",{id:"column7",className:"column",children:(0,p.jsx)("h5",{children:"Bedrooms"})}),(0,p.jsx)("div",{id:"column8",className:"column",children:(0,p.jsx)("h5",{children:"Agent"})}),(0,p.jsx)("div",{id:"column9",className:"column",children:(0,p.jsx)("h5",{children:"Score"})})]}),(0,p.jsx)("hr",{className:"property-divider"}),(0,p.jsx)("div",{className:"table-detail",children:f?f.map(((e,s)=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"table-content",children:[(0,p.jsx)("div",{className:"column",id:"column1",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:s+1})}),(0,p.jsx)("div",{className:"column",id:"column2",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.property_data.displayAddress})}),(0,p.jsx)("div",{className:"column",id:"column3",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.property_data.postcode})}),(0,p.jsx)("div",{className:"column",id:"column4",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.persona_data_list&&!e.school?e.persona_data_list[0].district:e.persona_data_list&&e.school?e.persona_data_list.district:""})}),(0,p.jsx)("div",{className:"column",id:"column5",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:null===e.property_data.added_revised?`Reduced ${e.property_data.reduced_revised}`:e.property_data.added_revised})}),(0,p.jsx)("div",{className:"column",id:"column6",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.property_data.price})}),(0,p.jsx)("div",{className:"column",id:"column7",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.property_data.bedrooms})}),(0,p.jsx)("div",{className:"column",id:"column8",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.property_data.agent})}),c&&"Wittle"===c.search_type?(0,p.jsx)("div",{className:"column",id:"column9",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.overall_lifestyle_score?(e.overall_lifestyle_score/10).toFixed(2):""})}):(0,p.jsx)("div",{className:"column",id:"column9",onClick:()=>W(e.property_data.url),children:(0,p.jsx)("h5",{children:e.school&&e.distance_meters?e.distance_meters.toFixed(0):""})}),(0,p.jsxs)("div",{id:"column10",className:"column",children:[(0,p.jsx)("button",{onClick:()=>R(e),children:"Go"}),i&&i.some((s=>s.rightmove_id===e.property_data.rightmove_id))?(0,p.jsx)("div",{className:"favourite-heart",id:"filled-heart",onClick:()=>o(e.property_data)}):(0,p.jsx)("div",{className:"favourite-heart",id:"empty-heart",onClick:()=>n(e)})]})]}),(0,p.jsx)("hr",{className:"property-divider"})]}))).slice(J,V):""})]}),f?(0,p.jsx)(j(),{pageCount:Math.ceil(f.length/50),onPageChange:q,containerClassName:"pagination",activeClassName:"active",previousLabel:"<",nextLabel:">",pageRangeDisplayed:0,breakLabel:"..."}):""]}):"Map"===A&&f?(0,p.jsxs)("div",{className:"property-map-view",children:[(0,p.jsxs)("div",{className:"map-block",children:[(0,p.jsx)("div",{className:"grid-list",children:f?f.map(((e,s)=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"property-content",children:[(0,p.jsx)("div",{className:"grid-left",children:(0,p.jsx)("img",{className:"property-image",alt:"property-image",loading:"lazy",onClick:()=>W(e.property_data.url),src:e.property_data.images})}),(0,p.jsxs)("div",{className:"grid-right",id:e.id,onMouseEnter:Y,children:[(0,p.jsxs)("h5",{className:"title",onClick:()=>W(e.property_data.url),children:[s+1,". ",e.property_data.displayAddress]}),(0,p.jsxs)("h5",{className:"sub-title",children:["Bedrooms: ",e.property_data.bedrooms]}),(0,p.jsxs)("h5",{className:"sub-title",children:["Price: ",e.property_data.price]}),c&&"Wittle"===c.search_type?(0,p.jsxs)("h5",{className:"sub-title",children:["Score: ",e.overall_lifestyle_score?(e.overall_lifestyle_score/10).toFixed(2):""]}):(0,p.jsxs)("h5",{className:"sub-title",children:["Distance: ",e&&e.distance_meters?e.distance_meters.toFixed(0):"","m"]}),i&&i.some((s=>s.rightmove_id===e.property_data.rightmove_id))?(0,p.jsx)("div",{className:"favourite-heart",id:"filled-heart",onClick:()=>o(e.property_data)}):(0,p.jsx)("div",{className:"favourite-heart",id:"empty-heart",onClick:()=>n(e)})]})]}),(0,p.jsx)("hr",{className:"dividing-line"})]}))).slice(J,V):""}),(0,p.jsx)("div",{className:"map-section",children:(0,p.jsxs)(_.ZP,{...G,mapboxApiAccessToken:"pk.eyJ1IjoiamRrdWxpZ293c2tpaSIsImEiOiJjbGF2NGdvdDYwMXplM3FsdGQzNXA1cWk1In0.XoVVFsT3TaaiBEdJt98h7w",mapStyle:"mapbox://styles/jdkuligowskii/clo8fop0l004b01pq000y65pb",onViewportChange:e=>{X(e)},center:G,onMove:e=>X(e.viewport),className:"profile-map",children:[f&&f.map(((e,s)=>(0,p.jsx)(_.Jx,{id:e.id,longitude:e.property_data.longitude,latitude:e.property_data.latitude,onClick:()=>{return s=e,console.log("selectd property ->",s),void T(s);var s},children:(0,p.jsx)("div",{className:"poi-background",children:s+1})},s))).slice(J,V),E?(0,p.jsx)(_.GI,{longitude:E.property_data.longitude,latitude:E.property_data.latitude,closeOnClick:!1,className:"item-popup",onClose:()=>T(null),children:(0,p.jsx)("div",{className:"popup-content",children:(0,p.jsx)("div",{className:"popup-border",children:(0,p.jsx)("h5",{className:"title",children:E.property_data.displayAddress})})})}):""]})})]}),f?(0,p.jsx)(j(),{pageCount:Math.ceil(f.length/50),onPageChange:q,containerClassName:"pagination",activeClassName:"active",previousLabel:"<",nextLabel:">",pageRangeDisplayed:0,breakLabel:"..."}):""]}):"Grid"===A&&f?(0,p.jsxs)("div",{className:"property-grid-view",children:[(0,p.jsx)("div",{className:"property-grid-items",children:f?f.map(((e,s)=>(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"property-item",children:[(0,p.jsxs)("div",{className:"property-item-left",children:[(0,p.jsx)("img",{className:"property-item-image",alt:"property-image",loading:"lazy",onClick:()=>W(e.property_data.url),src:e.property_data.images}),(0,p.jsxs)("div",{className:"property-core-info",children:["Sales"===c.channel?(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.property_data.price,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," "]}):(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.property_data.price,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," pcm"]}),c&&"Wittle"===c.search_type&&e.overall_lifestyle_score?(0,p.jsxs)("h3",{className:"match-score",children:["\ud83d\udd25 ",e.overall_lifestyle_score?(10*e.overall_lifestyle_score).toFixed(0):"","% match"]}):(0,p.jsxs)("h3",{className:"match-score",children:[e.school&&e.distance_meters?e.distance_meters.toFixed(0):"","m away"]}),i&&i.some((s=>s.rightmove_id===e.property_data.rightmove_id))?(0,p.jsx)("div",{className:"favourite-heart",id:"filled-heart",onClick:()=>o(e.property_data)}):(0,p.jsx)("div",{className:"favourite-heart",id:"empty-heart",onClick:()=>n(e)})]})]}),(0,p.jsxs)("div",{className:"property-item-right",children:[(0,p.jsxs)("div",{className:"detail-selections",children:[(0,p.jsxs)("div",{className:"key-selectors",children:[(0,p.jsx)("h3",{className:"detail-selector",style:{fontWeight:"Details"===B?"700":"500"},onClick:()=>H("Details"),children:"Details"}),(0,p.jsx)("h3",{className:"detail-selector",style:{fontWeight:"Insights"===B?"700":"500"},onClick:()=>H("Insights"),children:"Insights"}),(0,p.jsx)("h3",{className:"detail-selector",style:{fontWeight:"Floorplan"===B?"700":"500"},onClick:()=>H("Floorplan"),children:"Floorplan"}),(0,p.jsx)("button",{onClick:()=>R(e),children:"Explore"})]}),(0,p.jsx)("div",{className:"action"})]}),"Details"===B?(0,p.jsxs)("div",{className:"property-body",children:[(0,p.jsxs)("h2",{className:"property-title",children:[e.property_data.displayAddress,", ",e.persona_data_list&&!e.school?e.persona_data_list[0].district:e.persona_data_list&&!e.school?e.persona_data_list.district:""]}),(0,p.jsx)("h3",{className:"added-details",children:e.property_data.added_revised?`Added on ${e.property_data.added_revised}`:`Reduced on ${e.property_data.reduced_revised}`}),(0,p.jsxs)("div",{className:"key-elements",children:[(0,p.jsxs)("div",{className:"property-element-item",children:[(0,p.jsx)("div",{className:"element-icon",id:"bed"}),(0,p.jsxs)("h3",{children:[e.property_data.bedrooms," bedrooms"]})]}),(0,p.jsxs)("div",{className:"property-element-item",children:[(0,p.jsx)("div",{className:"element-icon",id:"bath"}),(0,p.jsxs)("h3",{children:[e.property_data.bathrooms," bathrooms"]})]}),(0,p.jsxs)("div",{className:"property-element-item",children:[(0,p.jsx)("div",{className:"element-icon",id:"size"}),(0,p.jsxs)("h3",{children:[e.property_data.size," sq. ft"]})]}),(0,p.jsxs)("div",{className:"property-element-item",children:[(0,p.jsx)("div",{className:"element-icon",id:"type"}),(0,p.jsx)("h3",{children:e.property_data.propertyType})]})]}),(0,p.jsxs)("div",{className:"property-features",children:[(0,p.jsx)("h3",{className:"features-title",children:"Features"}),(0,p.jsx)("div",{className:"feature-list",children:e&&e.property_data&&e.property_data.features?e.property_data.features.split(", ").map(((e,s)=>(0,p.jsx)("li",{className:"feature-item",children:e},s))):""})]})]}):"Insights"===B?(0,p.jsx)("div",{className:"property-body",children:e.persona_data_list&&!e.school?(0,p.jsxs)("div",{className:"insights-body",children:[(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"primaries"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].primary_percentile)," for primary schools"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"secondaries"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].secondary_percentile)," for secondary schools"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"parks"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].park_area_percentile)," for access to parks"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"gyms"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].gym_percentile)," for access to gyms"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"pubs"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].pub_percentile)," for access to pubs"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"restaurants"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].restaurant_percentile)," for restaurants"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"crime"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].crime_percentile)," for crime rates"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"tubes"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].tube_percentile)," for tube access"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"evs"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list[0].ev_percentile)," for EV access"]})]})]}):e.persona_data_list&&e.school?(0,p.jsxs)("div",{className:"insights-body",children:[(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"primaries"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.primary_percentile)," for primary schools"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"secondaries"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.secondary_percentile)," for secondary schools"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"parks"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.park_area_percentile)," for access to parks"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"gyms"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.gym_percentile)," for access to gyms"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"pubs"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.pub_percentile)," for access to pubs"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"restaurants"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.restaurant_percentile)," for restaurants"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"crime"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.crime_percentile)," for crime rates"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"tubes"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.tube_percentile)," for tube access"]})]}),(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",id:"evs"}),(0,p.jsxs)("h3",{className:"insight",children:[Q(e.persona_data_list.ev_percentile)," for EV access"]})]})]}):(0,p.jsxs)("div",{className:"insight-row",children:[(0,p.jsx)("div",{className:"insight-icon",children:"\ud83d\ude15"}),(0,p.jsx)("h3",{className:"insight",children:"No data to show"})]})}):"Floorplan"===B?(0,p.jsx)("div",{className:"property-body",children:(0,p.jsx)("div",{className:"floorplan-body",onClick:()=>W(e.property_data.floorplan_url),style:{backgroundImage:`url(${e.property_data.floorplan_url})`}})}):""]})]})}))).slice(J,V):""}),f?(0,p.jsx)(j(),{pageCount:Math.ceil(f.length/50),onPageChange:q,containerClassName:"pagination",activeClassName:"active",previousLabel:"<",nextLabel:">",pageRangeDisplayed:0,breakLabel:"..."}):""]}):f?"":(0,p.jsxs)("div",{className:"no-properties",children:[(0,p.jsx)("h1",{children:"\ud83d\udd0e Start a search to see some properties"}),(0,p.jsx)("button",{className:"edit-search",onClick:x,children:"Start search"})]})]})]}),(0,p.jsx)(g.Z,{propertyInputShow:y,handlePropertyInputClose:v,propertyFilters:c,setPropertyFilters:d,loadProperties:b,toggleStatus:N,loadPrimaryData:k,primarySearchDetails:C,setPrimarySearchDetails:P,selectedPrimary:D,setSelectedPrimary:F})]})};var b=e=>{let{agentSearches:s,loadUserData:t,currentClient:r,loadPropertiesFromSearch:n,handlePropertyInputShow:o,propertyInputShow:c,propertyFilters:d,setPropertyFilters:m,toggleStatus:u,handlePropertyInputClose:v,setPropertyInputShow:x,previousLocation:y,setPreviousLocation:j,isClient:_,setIsClient:N}=e;const[b,f]=(0,a.useState)("Sales"),[S,w]=(0,a.useState)({});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("section",{className:"agent-saved-properties",children:s?(0,p.jsxs)("div",{className:"saved-properties-body",children:[r?(0,p.jsxs)("h3",{className:"saved-number",children:[r.first_name," ",r.last_name," has ",s.filter((e=>e.channel===b)).length," saved ",b.toLocaleLowerCase()," searches "]}):(0,p.jsxs)("h3",{className:"saved-number",children:["You have ",s.filter((e=>e.channel===b)).length," saved ",b.toLocaleLowerCase()," searches "]}),(0,p.jsx)("div",{className:"saved-properties-grid",children:(0,p.jsx)("div",{className:"saved-properties-array",children:s?s.map(((e,s)=>(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"saved-property",id:"search-item",children:[(0,p.jsx)("h3",{className:"search-title",children:e.search_name}),(0,p.jsxs)("div",{className:"search-buttons",children:[(0,p.jsx)("button",{onClick:()=>(e=>{const s={...e,rental_price_min:e.price_min,rental_price_max:e.price_max};console.log(e),n(s)})(e),children:"Load"}),(0,p.jsx)("button",{onClick:()=>(e=>{const s={...e,rental_price_min:e.price_min,rental_price_max:e.price_max};delete e.price_min,delete e.price_max,m(s),x(!0)})(e),children:"Edit"}),(0,p.jsx)("button",{onClick:()=>(async e=>{const s=e.id;if(console.log("client id->",e.client),(0,l.Hb)())try{let a="";const r={headers:{Authorization:`Bearer ${(0,l.hP)()}`}};"Yes"===_?(a=`/api/client_searches/delete/${s}/`,r.headers["Client-ID"]=e.client):a=`/api/agent_searches/delete/${s}/`;const n=await i.Z.delete(a,r);console.log("Response: ",n),t()}catch(a){console.error("Error deleting search:",a)}})(e),children:"Delete"})]}),(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"money"}),"Sales"===e.channel?(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.price_min,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," - ",(0,p.jsx)(h.h3,{value:e.price_max,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," "]}):(0,p.jsxs)("h3",{children:[(0,p.jsx)(h.h3,{value:e.price_min,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," - ",(0,p.jsx)(h.h3,{value:e.price_max,displayType:"text",thousandSeparator:!0,prefix:"\xa3"})," pcm"]})]}),(0,p.jsxs)("div",{className:"saved-item",children:[(0,p.jsx)("div",{className:"saved-icon",id:"bed"}),(0,p.jsxs)("h3",{children:[e.bedrooms_min," - ",e.bedrooms_max," bedrooms"]})]}),(0,p.jsx)("h3",{className:"search-title",children:"Lifestyle"}),(0,p.jsxs)("div",{className:"lifestyle-pills",children:[e.restaurants?(0,p.jsx)("button",{className:"pills",children:"Restaurants"}):"",e.pubs?(0,p.jsx)("button",{className:"pills",children:"Pubs"}):"",e.supermarkets?(0,p.jsx)("button",{className:"pills",children:"Supermarkets"}):"",e.gyms?(0,p.jsx)("button",{className:"pills",children:"Gyms"}):"",e.parks?(0,p.jsx)("button",{className:"pills",children:"Parks"}):"",e.playgrounds?(0,p.jsx)("button",{className:"pills",children:"Playgrounds"}):"",e.tubes?(0,p.jsx)("button",{className:"pills",children:"Tubes"}):"",e.primaries?(0,p.jsx)("button",{className:"pills",children:"Primaries"}):"",e.secondaries?(0,p.jsx)("button",{className:"pills",children:"Secondaries"}):"",e.ev?(0,p.jsx)("button",{className:"pills",children:"EVs"}):"",e.crime?(0,p.jsx)("button",{className:"pills",children:"Crime"}):""]})]})}))):""})})]}):""}),(0,p.jsx)(g.Z,{propertyInputShow:c,handlePropertyInputClose:v,propertyFilters:d,setPropertyFilters:m,loadProperties:n,toggleStatus:u,editAgentSearch:async e=>{if((0,l.Hb)())try{const s={...d,price_min:d.rental_price_min,price_max:d.rental_price_max};delete s.rental_price_min,delete s.rental_price_max;let a="";"Yes"===_?(a=`/api/client_searches/update/${d.id}/`,s.client_id=e.client):a=`/api/agent_searches/update/${d.id}/`;const r=await i.Z.patch(a,s,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",r),t(),v(),n(d)}catch(s){console.error("Error updating search:",s)}},setPreviousLocation:j,previousLocation:"Edit"})]})};var f=e=>{let{clientList:s,loadUserData:t,userData:r,agentFavourites:n,personalView:o,setListingSelection:c,agentSearches:d,setPersonalView:h,editAgentSearch:u,isClient:v,setIsClient:g,loadPrimaryData:y,primarySearchDetails:j,setPrimarySearchDetails:_,selectedPrimary:f,setSelectedPrimary:S}=e;const[w,k]=(0,a.useState)(),[C,P]=(0,a.useState)(!1),[D,F]=(0,a.useState)(""),[I,A]=(0,a.useState)("Overview"),[L,E]=(0,a.useState)(),[T,O]=(0,a.useState)(""),[M,$]=(0,a.useState)(!1),[z,B]=(0,a.useState)(),[H,W]=(0,a.useState)(),[R,U]=(0,a.useState)({first_name:"",last_name:"",area:"",looking:"",link_sent:"",link_replied:"",email:""}),[Z,J]=(0,a.useState)({channel:"Sales",area:"",search_name:"",search_type:"",propertyType:"",garden:!1,size:null,bedrooms_min:null,bedrooms_max:null,rental_price_min:null,rental_price_max:null,primaries:!1,primaries_score:null,secondaries:!1,secondaries_score:null,parks:!1,parks_score:null,playgrounds:!1,playgrounds_score:null,gyms:!1,gyms_score:null,restaurants:!1,restaurants_score:null,pubs:!1,pubs_score:null,tubes:!1,tubes_score:null,supermarkets:!1,supermarkets_score:null,ev:!1,ev_score:null,crime:!1,crime_score:null}),V=e=>{F(!1)},G=()=>{$(!0),y()},X=e=>{$(!1)};(0,a.useEffect)((()=>{if(L&&n){const e=n.filter((e=>e.id===L.id));B(e[0].client_saved_properties),W(e[0].client_saved_searches),console.log("individual client details ->",e),console.log("client searches ->",e[0].client_saved_searches)}}),n,L);const Y=async e=>{const s={rightmove_id:e.property_data.rightmove_id,url:e.property_data.url,displayAddress:e.property_data.displayAddress,bathrooms:e.property_data.bathrooms,bedrooms:e.property_data.bedrooms,agent:e.property_data.agent,propertyType:e.property_data.propertyType,price_numeric:e.property_data.price_numeric,images:e.property_data.images,score:e.overall_lifestyle_score,channel:Z.channel,client_id:L.id};if((0,l.Hb)())try{const e=await i.Z.post("/api/agent_client_favourites/post/",s,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",e),t()}catch(a){console.error("Error saving favourite:",a)}},q=async e=>{const s=e.rightmove_id;if((0,l.Hb)())try{const e=await i.Z.delete("/api/agent_client_favourites/delete/",{headers:{Authorization:`Bearer ${(0,l.hP)()}`},data:{rightmove_id:s,client_id:L.id}});console.log("Response: ",e),t()}catch(a){console.error("Error deleting favourite:",a)}},Q=async()=>{if((0,l.Hb)())try{const e={...Z,price_min:Z.rental_price_min,price_max:Z.rental_price_max,client_id:L.id,bedrooms_min:Number.isInteger(Z.bedrooms_min)?Z.bedrooms_min:null,bedrooms_max:Number.isInteger(Z.bedrooms_max)?Z.bedrooms_max:null};delete e.rental_price_min,delete e.rental_price_max;const s=await i.Z.post("/api/client_searches/post/",e,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",s),t()}catch(e){console.error("Error saving search:",e)}},K=e=>{J((s=>({...s,[e]:!0!==s[e]})))};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("section",{className:"client-property-search",children:["Overview"===I?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"client-search-title",children:[s&&s.length>0?(0,p.jsxs)("h3",{children:["You have ",1===s.length?"1 client":`${s.length} clients`," in your Wittle client database"]}):(0,p.jsx)("h3",{children:"You don't have any clients yet, add clients to get Wittling!"}),(0,p.jsx)("button",{onClick:()=>{F(!0)},children:"Add new client"})]}),(0,p.jsx)("div",{className:"client-list-body",children:(0,p.jsxs)("div",{className:"client-list-table",children:[(0,p.jsxs)("div",{className:"table-headers",children:[(0,p.jsx)("div",{id:"column1",className:"column",children:(0,p.jsx)("h5",{})}),(0,p.jsx)("div",{id:"column2",className:"column",children:(0,p.jsx)("h5",{children:"#"})}),(0,p.jsx)("div",{id:"column3",className:"column",children:(0,p.jsx)("h5",{children:"Name"})}),(0,p.jsx)("div",{id:"column4",className:"column",children:(0,p.jsx)("h5",{children:"Current area"})}),(0,p.jsx)("div",{id:"column5",className:"column",children:(0,p.jsx)("h5",{children:"Looking"})}),(0,p.jsx)("div",{id:"column6",className:"column",children:(0,p.jsx)("h5",{children:"Date onboarded"})}),(0,p.jsx)("div",{id:"column7",className:"column",children:(0,p.jsx)("h5",{children:"Action"})})]}),(0,p.jsx)("hr",{className:"property-divider"}),(0,p.jsx)("div",{className:"table-detail",children:s?s.map(((e,t)=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"table-content",onClick:()=>(e=>{A("Profile");const t=s.filter((s=>s.email===e.email))[0];E(t),console.log("current client ->",t);const a=n.filter((e=>e.id===t.id));B(a[0].client_saved_properties),W(a[0].client_saved_searches),console.log("actual favourites ->",a)})(e),children:[(0,p.jsx)("div",{className:"column",id:"column1",children:(0,p.jsxs)("h5",{children:[e.first_name.charAt(0),e.last_name.charAt(0)]})}),(0,p.jsx)("div",{className:"column",id:"column2",children:(0,p.jsx)("h5",{children:t+1})}),(0,p.jsx)("div",{className:"column",id:"column3",children:(0,p.jsxs)("h5",{children:[e.first_name," ",e.last_name]})}),(0,p.jsx)("div",{className:"column",id:"column4",children:(0,p.jsx)("h5",{children:e.area})}),(0,p.jsx)("div",{className:"column",id:"column5",children:(0,p.jsx)("h5",{children:e.looking})}),(0,p.jsx)("div",{className:"column",id:"column6",children:(0,p.jsx)("h5",{children:e.date_onboarded})}),(0,p.jsx)("div",{className:"column",id:"column7",children:(0,p.jsx)("h5",{})})]}),(0,p.jsx)("hr",{className:"property-divider"})]}))):""})]})})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"client-top-summary",children:[(0,p.jsx)("div",{className:"go-back-button",id:"go-back",onClick:()=>A("Overview")}),(0,p.jsxs)("div",{className:"summary-block",children:[(0,p.jsx)("h3",{className:"summary-title",children:"Name"}),(0,p.jsx)("h3",{className:"summary-detail",children:L?L.first_name:""})]}),(0,p.jsxs)("div",{className:"summary-block",children:[(0,p.jsx)("h3",{className:"summary-title",children:"Area"}),(0,p.jsx)("h3",{className:"summary-detail",children:L?L.area:""})]}),(0,p.jsxs)("div",{className:"summary-block",children:[(0,p.jsx)("h3",{className:"summary-title",children:"Desired location"}),(0,p.jsx)("h3",{className:"summary-detail",children:L?L.looking:""})]})]}),(0,p.jsxs)("div",{className:"section-selectors",children:[(0,p.jsx)("h3",{className:"selector-button "+("Profile"===I?"active":"inactive"),id:"left",onClick:()=>A("Profile"),children:"Profile"}),(0,p.jsx)("h3",{className:"selector-button "+("Client properties"===I?"active":"inactive"),id:"middle",onClick:()=>A("Client properties"),children:"Properties"}),(0,p.jsx)("h3",{className:"selector-button "+("Client saved properties"===I?"active":"inactive"),id:"middle",onClick:()=>A("Client saved properties"),children:"Saved properties"}),(0,p.jsx)("h3",{className:"selector-button "+("Client saved searches"===I?"active":"inactive"),id:"right",onClick:()=>A("Client saved searches"),children:"Saved searches"})]})]}),"Profile"===I?(0,p.jsx)(p.Fragment,{children:L?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Name"}),(0,p.jsxs)("h3",{className:"client-detail-content",children:[L.first_name," ",L.last_name]})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Email"}),(0,p.jsx)("h3",{className:"client-detail-content",children:L.email})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Area"}),(0,p.jsx)("h3",{className:"client-detail-content",children:L.area})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Desired location"}),(0,p.jsx)("h3",{className:"client-detail-content",children:L.looking})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Date onboarded"}),(0,p.jsx)("h3",{className:"client-detail-content",children:L.date_onboarded})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Link sent"}),(0,p.jsx)("h3",{className:"client-detail-content",children:""===L.link_sent?"No":L.link_sent})]}),(0,p.jsxs)("div",{className:"client-detail-block",children:[(0,p.jsx)("h3",{className:"client-detail-title",children:"Details recieved"}),(0,p.jsx)("h3",{className:"client-detail-content",children:""===L.link_replied?"No":L.link_replied})]})]}):""}):"Client properties"===I?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(N,{clientList:s,userData:r,loadUserData:t,propertyFilters:Z,setPropertyFilters:J,agentFavourites:z,deleteAgentFavourite:q,addAgentFavourite:Y,currentClient:L,handlePropertyInputShow:G,propertyInputShow:M,handlePropertyInputClose:X,toggleStatus:K,loading:C,setLoading:P,properties:w,setProperties:k,loadProperties:async()=>{P(!0),X(),console.log("activated"),""!==Z.search_name&&Q(),console.log("client property filters",Z);const e=new URLSearchParams;Object.entries(Z).forEach((s=>{let[t,a]=s;null!==a&&void 0!==a&&"channel"!==t&&e.append(t,a)}));try{let s="";if("Amenity"===Z.search_type){s=`/api/personas/sales/primaries/?school_id=${f.value.id}`}else"Lettings"===Z.channel?s=`/api/personas/rental/?${e.toString()}`:"Sales"===Z.channel&&(s=`/api/personas/sales/?${e.toString()}`);const{data:t}=await i.Z.get(s,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});"Amenity"!==Z.search_type&&t.sort(((e,s)=>s.overall_lifestyle_score-e.overall_lifestyle_score)),console.log("combined data ->",t),k(t),window.localStorage.setItem("client-properties",JSON.stringify(t)),window.localStorage.setItem("client-property-filters",JSON.stringify(Z)),window.localStorage.setItem("client-email",JSON.stringify(L.email)),P(!1)}catch(s){console.error("can't access combined data ->",s)}},primarySearchDetails:j,setPrimarySearchDetails:_,selectedPrimary:f,setSelectedPrimary:S})}):"Client saved properties"===I?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(m,{agentFavourites:z,deleteAgentFavourite:q,addAgentFavourite:Y,userData:r,loadUserData:t,currentClient:L})}):"Client saved searches"===I?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(b,{userData:r,loadUserData:t,agentSearches:H,setPersonalView:h,loadPropertiesFromSearch:async e=>{P(!0),A("Client properties");const s=new URLSearchParams;Object.entries(e).forEach((e=>{let[t,a]=e;null!==a&&void 0!==a&&"channel"!==t&&s.append(t,a)}));try{let t="";"Lettings"===e.channel?t=`/api/personas/rental/?${s.toString()}`:"Sales"===e.channel&&(t=`/api/personas/sales/?${s.toString()}`);const{data:a}=await i.Z.get(t,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});a.sort(((e,s)=>s.overall_lifestyle_score-e.overall_lifestyle_score)),console.log("combined data ->",a),k(a),window.localStorage.setItem("top-properties",JSON.stringify(a)),window.localStorage.setItem("top-property-filters",JSON.stringify(e)),P(!1)}catch(t){console.error("can't access combined data ->",t)}},handlePropertyInputShow:G,propertyInputShow:M,handlePropertyInputClose:X,propertyFilters:Z,setPropertyFilters:J,toggleStatus:K,setPropertyInputShow:$,editAgentSearch:u,previousLocation:T,setPreviousLocation:O,isClient:"Yes",setIsClient:g,currentClient:L})}):""]}),(0,p.jsx)(x,{clientInputShow:D,handleClientInputClose:V,clientInputDetails:R,setClientInputDetails:U,addNewClient:async e=>{if((0,l.Hb)())try{const e=await i.Z.post("/api/agent_clients/add_client/",R,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",e),t(),V()}catch(s){console.error("Error saving favourite:",s)}}})]})};var S=e=>{let{setSearchSelection:s}=e;return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("section",{className:"agent-search-home",children:[(0,p.jsx)("h1",{className:"title",children:"Wittle property search"}),(0,p.jsx)("h3",{className:"sub-title",children:"Wittle's property search is a new way to find properties. Scan your properties and the wider market based on your client's requirements. Tailor searches to lifestyle needs, properrty size or within school catchments"}),(0,p.jsxs)("div",{className:"search-options",children:[(0,p.jsxs)("div",{className:"search-option",onClick:()=>s("Client view"),children:[(0,p.jsx)("div",{className:"search-image",id:"personal"}),(0,p.jsx)("h3",{children:"Client search"}),(0,p.jsx)("p",{children:"Search and save properties that suit your clients' needs."})]}),(0,p.jsxs)("div",{className:"search-option",onClick:()=>s("Personal view"),children:[(0,p.jsx)("div",{className:"search-image",id:"client"}),(0,p.jsx)("h3",{children:"Personal search"}),(0,p.jsx)("p",{children:"Browse search functionality freely to test how it works for you."})]})]})]})})};var w=e=>{let{personalView:s,userData:t,loadUserData:r,setListingSelection:n,agentFavourites:o,addAgentFavourite:c,deleteAgentFavourite:h,propertyFilters:u,setPropertyFilters:v,addAgentSearch:x,agentSearches:g,setPersonalView:y,editAgentSearch:j,isClient:_,setIsClient:N,loadPrimaryData:f,primarySearchDetails:S,setPrimarySearchDetails:w,selectedPrimary:k,setSelectedPrimary:C,initialPropertyFilters:P}=e;const[D,F]=(0,a.useState)([]),[I,A]=(0,a.useState)(!1),[L,E]=(0,a.useState)(!1),[T,O]=(0,a.useState)(""),[M,$]=(0,a.useState)(!1),z=()=>{E(!0),f()},B=e=>{E(!1)},H=e=>{v((s=>({...s,[e]:!0!==s[e]})))};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"section-selectors "+(M?"single":""),children:[(0,p.jsx)("h3",{className:"selector-button "+("Properties"===s?"active":"inactive"),id:"left",onClick:()=>y("Properties"),children:"Properties"}),(0,p.jsx)("h3",{className:"selector-button "+("Saved properties"===s?"active":"inactive"),id:"middle",onClick:()=>y("Saved properties"),children:"Saved properties"}),(0,p.jsx)("h3",{className:"selector-button "+("Saved searches"===s?"active":"inactive"),id:"right",onClick:()=>y("Saved searches"),children:"Saved searches"})]}),"Properties"===s?(0,p.jsx)(d.Z,{userData:t,loadUserData:r,setListingSelection:n,agentFavourites:o,addAgentFavourite:c,deleteAgentFavourite:h,propertyFilters:u,setPropertyFilters:v,addAgentSearch:x,properties:D,setProperties:F,loadProperties:async()=>{A(!0),B(),""!==u.search_name&&x();const e=new URLSearchParams;Object.entries(u).forEach((s=>{let[t,a]=s;null!==a&&void 0!==a&&"channel"!==t&&e.append(t,a)}));try{let s="";if("Amenity"===u.search_type){s=`/api/personas/sales/primaries/?school_id=${k.value.id}`}else"Lettings"===u.channel?s=`/api/personas/rental/?${e.toString()}`:"Sales"===u.channel&&(s=`/api/personas/sales/?${e.toString()}`,console.log(s));const{data:t}=await i.Z.get(s,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});"Amenity"!==u.search_type&&t.sort(((e,s)=>s.overall_lifestyle_score-e.overall_lifestyle_score)),console.log("combined data ->",t),F(t),window.localStorage.setItem("top-properties",JSON.stringify(t)),window.localStorage.setItem("top-property-filters",JSON.stringify(u)),A(!1)}catch(s){console.error("can't access combined data ->",s),A(!1)}},loading:I,propertyInputShow:L,handlePropertyInputShow:z,handlePropertyInputClose:B,toggleStatus:H,loadPrimaryData:f,primarySearchDetails:S,setPrimarySearchDetails:w,selectedPrimary:k,setSelectedPrimary:C,singleProperty:M,setSingleProperty:$}):"Saved properties"===s?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(m,{agentFavourites:o,deleteAgentFavourite:h,userData:t,loadUserData:r})}):"Saved searches"===s?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(b,{userData:t,loadUserData:r,agentSearches:g,setPersonalView:y,loadPropertiesFromSearch:async e=>{A(!0),y("Properties");const s=new URLSearchParams;Object.entries(e).forEach((e=>{let[t,a]=e;null!==a&&void 0!==a&&"channel"!==t&&s.append(t,a)})),console.log("new filters ->",e);try{let t="";"Lettings"===e.channel?t=`/api/personas/rental/?${s.toString()}`:"Sales"===e.channel&&(t=`/api/personas/sales/?${s.toString()}`);const{data:a}=await i.Z.get(t,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});a.sort(((e,s)=>s.overall_lifestyle_score-e.overall_lifestyle_score)),console.log("combined data ->",a),F(a),window.localStorage.setItem("top-properties",JSON.stringify(a)),window.localStorage.setItem("top-property-filters",JSON.stringify(e)),A(!1)}catch(t){console.error("can't access combined data ->",t)}},handlePropertyInputShow:z,propertyInputShow:L,handlePropertyInputClose:B,propertyFilters:u,setPropertyFilters:v,toggleStatus:H,setPropertyInputShow:E,editAgentSearch:j,previousLocation:T,setPreviousLocation:O,isClient:"No",setIsClient:N})}):""]})};var k=()=>{const e=(0,r.s0)(),[s,t]=(0,a.useState)("Comparison"),[d,h]=(0,a.useState)("Comparison"),[m,u]=(0,a.useState)(""),[v,x]=(0,a.useState)("Home"),[g,y]=(0,a.useState)("Properties"),[j,_]=(0,a.useState)(),[N,b]=(0,a.useState)([]),[k,C]=(0,a.useState)([]),[P,D]=(0,a.useState)(!1),[F,I]=(0,a.useState)(),[A,L]=(0,a.useState)(),[E,T]=(0,a.useState)(),[O,M]=(0,a.useState)(),[$,z]=(0,a.useState)(),[B,H]=(0,a.useState)(),[W,R]=(0,a.useState)(),[U,Z]=(0,a.useState)({channel:"Sales",area:"",search_name:"",search_type:"",propertyType:"",garden:!1,stpp:!1,granted:!1,size:null,bedrooms_min:null,bedrooms_max:null,rental_price_min:null,rental_price_max:null,primaries:!1,primaries_score:null,secondaries:!1,secondaries_score:null,parks:!1,parks_score:null,playgrounds:!1,playgrounds_score:null,gyms:!1,gyms_score:null,restaurants:!1,restaurants_score:null,pubs:!1,pubs_score:null,tubes:!1,tubes_score:null,supermarkets:!1,supermarkets_score:null,ev:!1,ev_score:null,crime:!1,crime_score:null}),[J,V]=(0,a.useState)({channel:"Sales",area:"",search_name:"",search_type:"",propertyType:"",garden:!1,stpp:!1,granted:!1,size:null,bedrooms_min:null,bedrooms_max:null,rental_price_min:null,rental_price_max:null,primaries:!1,primaries_score:null,secondaries:!1,secondaries_score:null,parks:!1,parks_score:null,playgrounds:!1,playgrounds_score:null,gyms:!1,gyms_score:null,restaurants:!1,restaurants_score:null,pubs:!1,pubs_score:null,tubes:!1,tubes_score:null,supermarkets:!1,supermarkets_score:null,ev:!1,ev_score:null,crime:!1,crime_score:null}),G=()=>{if((0,l.Hb)()){(async()=>{try{const{data:e}=await i.Z.get(`/api/auth/profile/${(0,l.Nh)()}/`,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("user data ->",e),I(e),T(e.agent_saved_properties),z(e.client_details),H(e.client_details),M(e.agent_searches),console.log("client details ->",e.client_details)}catch(e){L(!0),console.log(e)}})()}else e("/access-denied"),console.log("no account")};(0,a.useEffect)((()=>{G()}),[]);const X=s=>{localStorage.removeItem("wittle-user-token"),localStorage.removeItem("wittle-username"),e("/login")},Y=()=>{try{(async()=>{const{data:e}=await i.Z.get("/api/primaries/");console.log("primaries data for search ->",e),b(e)})()}catch(e){L(!0),console.log(e)}};return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("section",{className:"agent-profile-page",children:[(0,p.jsx)("div",{className:"desktop-nav",children:(0,p.jsx)(o.Z,{navbarColour:"#FDF7F0"})}),(0,p.jsx)("div",{className:"mobile-nav",children:(0,p.jsx)(n.Z,{setProfileContent:t,profileContent:s,profileDetail:d,setProfileDetail:h})}),(0,p.jsx)(c.Z,{setProfileDetail:h,variableSide:P,setProfileContent:t,setVariableSide:D,userData:F}),F&&"Trial expired"===F.usage_stats[0].package?(0,p.jsx)("section",{className:"main-body remove-margin",children:(0,p.jsx)("section",{className:"main-body-details",children:(0,p.jsxs)("section",{className:"listing-generator",children:[(0,p.jsxs)("div",{className:"listing-options",children:[(0,p.jsx)("div",{className:"listing-buttons"}),(0,p.jsx)("div",{className:"logout-button",onClick:X,children:(0,p.jsx)("div",{className:"logout-icon"})})]}),(0,p.jsxs)("div",{className:"no-access-body",children:[(0,p.jsx)("div",{className:"no-access-image"}),(0,p.jsx)("h1",{className:"no-access-title",children:"Oops! Dead end"}),(0,p.jsx)("h3",{className:"no-access-message",children:"You no longer have access to this content. Get in touch to upgrade your account and access the Wittle magic."})]})]})})}):(0,p.jsx)("section",{className:"main-body",children:(0,p.jsx)("section",{className:"main-body-details",children:(0,p.jsxs)("section",{className:"property-search",children:[(0,p.jsxs)("div",{className:"listing-options",children:[(0,p.jsxs)("div",{className:"listing-buttons",children:[(0,p.jsx)("h5",{className:"no-print",onClick:()=>x("Home"),style:{borderBottom:"Home"===v?"3px solid #ED6B86":"none",textUnderlineOffset:"Home"===v?"0.5em":"initial",fontWeight:"Home"===v?"700":"400"},children:"Home"}),(0,p.jsx)("h5",{className:"no-print",onClick:()=>x("Client view"),style:{borderBottom:"Client view"===v?"3px solid #ED6B86":"none",textUnderlineOffset:"Client view"===v?"0.5em":"initial",fontWeight:"Client view"===v?"700":"400"},children:"Client view"}),(0,p.jsx)("h5",{className:"no-print",onClick:()=>x("Personal view"),style:{borderBottom:"Personal view"===v?"3px solid #ED6B86":"none",textUnderlineOffset:"Personal view"===v?"0.5em":"initial",fontWeight:"Personal view"===v?"700":"400"},children:"Personal view"})]}),(0,p.jsx)("div",{className:"logout-button",onClick:X,children:(0,p.jsx)("div",{className:"logout-icon"})})]}),(0,p.jsx)("hr",{className:"title-line"}),"Home"===v?(0,p.jsx)(S,{setSearchSelection:x}):"Client view"===v?(0,p.jsx)(f,{clientList:$,userData:F,loadUserData:G,setListingSelection:u,agentFavourites:B,isClient:j,loadPrimaryData:Y,primarySearchDetails:N,setPrimarySearchDetails:b,selectedPrimary:k,setSelectedPrimary:C}):"Personal view"===v?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(w,{userData:F,loadUserData:G,setListingSelection:u,agentFavourites:E,addAgentFavourite:async e=>{const s={rightmove_id:e.property_data.rightmove_id,url:e.property_data.url,displayAddress:e.property_data.displayAddress,bathrooms:e.property_data.bathrooms,bedrooms:e.property_data.bedrooms,agent:e.property_data.agent,propertyType:e.property_data.propertyType,price_numeric:e.property_data.price_numeric,images:e.property_data.images,score:e.overall_lifestyle_score,channel:U.channel};if((0,l.Hb)())try{const e=await i.Z.post("/api/agent_favourites/",s,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",e),G()}catch(t){console.error("Error saving favourite:",t)}},deleteAgentFavourite:async e=>{console.log("delete item ->",e);const s=e.rightmove_id;if((0,l.Hb)())try{const e=await i.Z.delete("/api/agent_favourites/delete/",{headers:{Authorization:`Bearer ${(0,l.hP)()}`},data:{rightmove_id:s}});console.log("Response: ",e),G()}catch(t){console.error("Error deleting favourite:",t)}},propertyFilters:U,setPropertyFilters:Z,addAgentSearch:async e=>{if((0,l.Hb)())try{const e={...U,price_min:U.rental_price_min,price_max:U.rental_price_max};delete e.rental_price_min,delete e.rental_price_max;const s=await i.Z.post("/api/agent_searches/",e,{headers:{Authorization:`Bearer ${(0,l.hP)()}`}});console.log("Response: ",s),G()}catch(s){console.error("Error saving search:",s)}},agentSearches:O,setPersonalView:y,personalView:g,isClient:j,setIsClient:_,loadPrimaryData:Y,primarySearchDetails:N,setPrimarySearchDetails:b,selectedPrimary:k,setSelectedPrimary:C,initialPropertyFilters:J})}):""]})})})]})})}},7842:function(e,s,t){t.d(s,{Z:function(){return c}});var a=t(2791);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},i.apply(this,arguments)}var r=a.createElement("svg",{viewBox:"-2 -5 14 20",height:"100%",width:"100%",style:{position:"absolute",top:0}},a.createElement("path",{d:"M9.9 2.12L7.78 0 4.95 2.828 2.12 0 0 2.12l2.83 2.83L0 7.776 2.123 9.9 4.95 7.07 7.78 9.9 9.9 7.776 7.072 4.95 9.9 2.12",fill:"#fff",fillRule:"evenodd"})),l=a.createElement("svg",{height:"100%",width:"100%",viewBox:"-2 -5 17 21",style:{position:"absolute",top:0}},a.createElement("path",{d:"M11.264 0L5.26 6.004 2.103 2.847 0 4.95l5.26 5.26 8.108-8.107L11.264 0",fill:"#fff",fillRule:"evenodd"}));function n(e){if(7===e.length)return e;for(var s="#",t=1;t<4;t+=1)s+=e[t]+e[t];return s}function o(e,s,t,a,i){return function(e,s,t,a,i){var r=(e-t)/(s-t);if(0===r)return a;if(1===r)return i;for(var l="#",n=1;n<6;n+=2){var o=parseInt(a.substr(n,2),16),c=parseInt(i.substr(n,2),16),d=Math.round((1-r)*o+r*c).toString(16);1===d.length&&(d="0"+d),l+=d}return l}(e,s,t,n(a),n(i))}var c=function(e){function s(s){e.call(this,s);var t=s.height,a=s.width,i=s.checked;this.t=s.handleDiameter||t-2,this.i=Math.max(a-t,a-(t+this.t)/2),this.o=Math.max(0,(t-this.t)/2),this.state={h:i?this.i:this.o},this.l=0,this.u=0,this.p=this.p.bind(this),this.v=this.v.bind(this),this.g=this.g.bind(this),this.k=this.k.bind(this),this.m=this.m.bind(this),this.M=this.M.bind(this),this.T=this.T.bind(this),this.$=this.$.bind(this),this.C=this.C.bind(this),this.D=this.D.bind(this),this.O=this.O.bind(this),this.S=this.S.bind(this)}return e&&(s.__proto__=e),(s.prototype=Object.create(e&&e.prototype)).constructor=s,s.prototype.componentDidMount=function(){this.W=!0},s.prototype.componentDidUpdate=function(e){e.checked!==this.props.checked&&this.setState({h:this.props.checked?this.i:this.o})},s.prototype.componentWillUnmount=function(){this.W=!1},s.prototype.I=function(e){this.H.focus(),this.setState({R:e,j:!0,B:Date.now()})},s.prototype.L=function(e){var s=this.state,t=s.R,a=s.h,i=(this.props.checked?this.i:this.o)+e-t;s.N||e===t||this.setState({N:!0});var r=Math.min(this.i,Math.max(this.o,i));r!==a&&this.setState({h:r})},s.prototype.U=function(e){var s=this.state,t=s.h,a=s.N,i=s.B,r=this.props.checked,l=(this.i+this.o)/2;this.setState({h:this.props.checked?this.i:this.o});var n=Date.now()-i;(!a||n<250||r&&t<=l||!r&&t>=l)&&this.A(e),this.W&&this.setState({N:!1,j:!1}),this.l=Date.now()},s.prototype.p=function(e){e.preventDefault(),"number"==typeof e.button&&0!==e.button||(this.I(e.clientX),window.addEventListener("mousemove",this.v),window.addEventListener("mouseup",this.g))},s.prototype.v=function(e){e.preventDefault(),this.L(e.clientX)},s.prototype.g=function(e){this.U(e),window.removeEventListener("mousemove",this.v),window.removeEventListener("mouseup",this.g)},s.prototype.k=function(e){this.X=null,this.I(e.touches[0].clientX)},s.prototype.m=function(e){this.L(e.touches[0].clientX)},s.prototype.M=function(e){e.preventDefault(),this.U(e)},s.prototype.$=function(e){Date.now()-this.l>50&&(this.A(e),Date.now()-this.u>50&&this.W&&this.setState({j:!1}))},s.prototype.C=function(){this.u=Date.now()},s.prototype.D=function(){this.setState({j:!0})},s.prototype.O=function(){this.setState({j:!1})},s.prototype.S=function(e){this.H=e},s.prototype.T=function(e){e.preventDefault(),this.H.focus(),this.A(e),this.W&&this.setState({j:!1})},s.prototype.A=function(e){var s=this.props;(0,s.onChange)(!s.checked,e,s.id)},s.prototype.render=function(){var e=this.props,s=e.checked,t=e.disabled,r=e.className,l=e.offColor,n=e.onColor,c=e.offHandleColor,d=e.onHandleColor,h=e.checkedIcon,p=e.uncheckedIcon,m=e.checkedHandleIcon,u=e.uncheckedHandleIcon,v=e.boxShadow,x=e.activeBoxShadow,g=e.height,y=e.width,j=e.borderRadius,_=function(e,s){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===s.indexOf(a)&&(t[a]=e[a]);return t}(e,["checked","disabled","className","offColor","onColor","offHandleColor","onHandleColor","checkedIcon","uncheckedIcon","checkedHandleIcon","uncheckedHandleIcon","boxShadow","activeBoxShadow","height","width","borderRadius","handleDiameter"]),N=this.state,b=N.h,f=N.N,S=N.j,w={position:"relative",display:"inline-block",textAlign:"left",opacity:t?.5:1,direction:"ltr",borderRadius:g/2,WebkitTransition:"opacity 0.25s",MozTransition:"opacity 0.25s",transition:"opacity 0.25s",touchAction:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"},k={height:g,width:y,margin:Math.max(0,(this.t-g)/2),position:"relative",background:o(b,this.i,this.o,l,n),borderRadius:"number"==typeof j?j:g/2,cursor:t?"default":"pointer",WebkitTransition:f?null:"background 0.25s",MozTransition:f?null:"background 0.25s",transition:f?null:"background 0.25s"},C={height:g,width:Math.min(1.5*g,y-(this.t+g)/2+1),position:"relative",opacity:(b-this.o)/(this.i-this.o),pointerEvents:"none",WebkitTransition:f?null:"opacity 0.25s",MozTransition:f?null:"opacity 0.25s",transition:f?null:"opacity 0.25s"},P={height:g,width:Math.min(1.5*g,y-(this.t+g)/2+1),position:"absolute",opacity:1-(b-this.o)/(this.i-this.o),right:0,top:0,pointerEvents:"none",WebkitTransition:f?null:"opacity 0.25s",MozTransition:f?null:"opacity 0.25s",transition:f?null:"opacity 0.25s"},D={height:this.t,width:this.t,background:o(b,this.i,this.o,c,d),display:"inline-block",cursor:t?"default":"pointer",borderRadius:"number"==typeof j?j-1:"50%",position:"absolute",transform:"translateX("+b+"px)",top:Math.max(0,(g-this.t)/2),outline:0,boxShadow:S?x:v,border:0,WebkitTransition:f?null:"background-color 0.25s, transform 0.25s, box-shadow 0.15s",MozTransition:f?null:"background-color 0.25s, transform 0.25s, box-shadow 0.15s",transition:f?null:"background-color 0.25s, transform 0.25s, box-shadow 0.15s"},F={height:this.t,width:this.t,opacity:Math.max(2*(1-(b-this.o)/(this.i-this.o)-.5),0),position:"absolute",left:0,top:0,pointerEvents:"none",WebkitTransition:f?null:"opacity 0.25s",MozTransition:f?null:"opacity 0.25s",transition:f?null:"opacity 0.25s"},I={height:this.t,width:this.t,opacity:Math.max(2*((b-this.o)/(this.i-this.o)-.5),0),position:"absolute",left:0,top:0,pointerEvents:"none",WebkitTransition:f?null:"opacity 0.25s",MozTransition:f?null:"opacity 0.25s",transition:f?null:"opacity 0.25s"};return a.createElement("div",{className:r,style:w},a.createElement("div",{className:"react-switch-bg",style:k,onClick:t?null:this.T,onMouseDown:function(e){return e.preventDefault()}},h&&a.createElement("div",{style:C},h),p&&a.createElement("div",{style:P},p)),a.createElement("div",{className:"react-switch-handle",style:D,onClick:function(e){return e.preventDefault()},onMouseDown:t?null:this.p,onTouchStart:t?null:this.k,onTouchMove:t?null:this.m,onTouchEnd:t?null:this.M,onTouchCancel:t?null:this.O},u&&a.createElement("div",{style:F},u),m&&a.createElement("div",{style:I},m)),a.createElement("input",i({},{type:"checkbox",role:"switch","aria-checked":s,checked:s,disabled:t,style:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",width:1}},_,{ref:this.S,onFocus:this.D,onBlur:this.O,onKeyUp:this.C,onChange:this.$})))},s}(a.Component);c.defaultProps={disabled:!1,offColor:"#888",onColor:"#080",offHandleColor:"#fff",onHandleColor:"#fff",uncheckedIcon:r,checkedIcon:l,boxShadow:null,activeBoxShadow:"0 0 2px 3px #3bf",height:28,width:56}}}]);
//# sourceMappingURL=341.4a57bbe4.chunk.js.map