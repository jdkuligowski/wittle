"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[345],{63345:function(e,s,a){a.r(s);var t=a(72791),o=a(55294),n=a(57689),c=a(11087),l=a(82570),i=(a(99696),a(97165)),r=a(21830),u=a.n(r),d=a(80184);s.default=()=>{const e=(0,n.s0)(),s=(0,n.TH)();(0,t.useEffect)((()=>{console.log("Checking URL:",window.location.search);const s=new URLSearchParams(window.location.search).get("success");console.log("Register Success:",s),s&&u().fire({title:"Registration Successful!",text:"You've successfully registered your account - log in to start Wittling",icon:"success",confirmButtonColor:"#ED6B86",confirmButtonText:"Log In",customClass:{title:"popup-swal-title",popup:"popup-swal-body",confirmButton:"popup-swal-confirm",cancelButton:"popup-swal-cancel"}}).then((s=>{s.isConfirmed&&e("/login")}))}),[s,e]);const[a,r]=(0,t.useState)({email:"",password:"",account:""}),p=e=>{const{name:s,value:t}=e.target;let o="";"email"!==s||(0,l.isEmail)(t)?"password"===s&&(o=N(t)):o="Invalid email address",v({...j,[s]:t}),r({...a,[s]:o})},[m,g]=(0,t.useState)("password"),[h,w]=(0,t.useState)(!1),[f,x]=(0,t.useState)(!1),[j,v]=(0,t.useState)({email:"",username:"",password:"",password_confirmation:"",first_name:"",last_name:""}),[y,S]=(0,t.useState)({email:"",username:"",password:"",password_confirmation:"",first_name:"",last_name:"",post:""}),N=e=>{const s=(0,l.matches)(e,/[A-Z]/),a=(0,l.matches)(e,/[a-z]/),t=(0,l.matches)(e,/\d/),o=(0,l.matches)(e,/[^A-Za-z0-9]/);return(0,l.isLength)(e,{min:8})?s?a?t?o?"":"Password must contain at least one special character":"Password must contain at least one digit":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter":"Password must be at least 8 characters long"},k=async()=>{if((0,i.Hb)()){console.log("trying to increase");try{const{data:e}=await o.Z.post("/api/usage/overall/",{},{headers:{Authorization:`Bearer ${(0,i.hP)()}`}});console.log(e),"success"===e.status?console.log("Usage count increased successfully"):console.error("Failed to increase usage count:",e.message)}catch(s){console.error("Error:",s)}}else e("/access-denied"),console.log("logged out")};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("section",{className:"login-page",children:(0,d.jsxs)("section",{className:"login-content login",children:[(0,d.jsx)("div",{className:"logo-section",children:(0,d.jsx)("div",{className:"wittle-logo",onClick:()=>e("/")})}),(0,d.jsx)("h1",{children:"Sign in"}),(0,d.jsxs)("div",{className:"input-section",children:[(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Email address"}),(0,d.jsx)("input",{placeholder:"Enter email address",type:"email",name:"email",className:"input",value:j.email,onChange:p}),a.email&&(0,d.jsxs)("p",{className:"error",children:["* ",a.email]})]}),(0,d.jsxs)("div",{className:"login-input",children:[(0,d.jsx)("h3",{children:"Password"}),(0,d.jsx)("input",{placeholder:"Enter password",type:m,name:"password",className:"password-input",value:j.password,onChange:p}),a.password&&(0,d.jsxs)("p",{className:"error",children:["* ",a.password]})]})]}),(0,d.jsx)("button",{onClick:async s=>{var t;if(s.preventDefault(),!a.email&&!a.password)try{const{data:s}=await o.Z.post("/api/auth/login/",j);t=s.token,window.localStorage.setItem("wittle-user-token",t),console.log("token ->",s),window.localStorage.setItem("wittle-username",s.email),e("/agents/profile"),k()}catch(n){const e=n.response.data.detail;e&&"Invalid credentials"===e&&r({...a,account:"Account not found"})}},type:"submit",children:"Sign in"}),a.account&&(0,d.jsxs)("p",{className:"error",id:"account",children:["* ",a.account]}),(0,d.jsxs)("p",{children:["Forgotten your login details? ",(0,d.jsx)(c.rU,{to:"/password-reset-request/",children:(0,d.jsx)("span",{children:"Request reset"})})]})]})})})}}}]);
//# sourceMappingURL=345.ef3027d3.chunk.js.52c2debd7c4f.map